614ddaa25f865045c1797d74e7670ef2
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createSuite = createSuite;
exports.updateSuite = updateSuite;
exports.deleteSuite = deleteSuite;
exports.listSuites = listSuites;
exports.assignCaseToSuite = assignCaseToSuite;
exports.removeCaseFromSuite = removeCaseFromSuite;
exports.listCasesInSuite = listCasesInSuite;
exports.suiteCaseCount = suiteCaseCount;
const pgClient_1 = require("../../../infrastructure/database/pgClient");
async function createSuite(data) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query(`INSERT INTO suites (release_id, name, description, executor, environment, due_date) VALUES ($1, $2, $3, $4, $5, $6) RETURNING *`, [data.releaseId, data.name, data.description, data.executor, data.environment, data.dueDate]);
    return rowToSuite(result.rows[0]);
}
async function updateSuite(id, patch) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query(`UPDATE suites SET name=$1, description=$2, executor=$3, environment=$4, due_date=$5 WHERE id=$6 RETURNING *`, [patch.name, patch.description, patch.executor, patch.environment, patch.dueDate, id]);
    if (result.rows.length === 0)
        return null;
    return rowToSuite(result.rows[0]);
}
async function deleteSuite(id) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query('DELETE FROM suites WHERE id = $1', [id]);
    return (result.rowCount ?? 0) > 0;
}
async function listSuites() {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query('SELECT * FROM suites ORDER BY id');
    return result.rows.map(rowToSuite);
}
async function assignCaseToSuite(suiteId, testcaseId) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    await pgClient.query('INSERT INTO suite_cases (suite_id, testcase_id) VALUES ($1, $2) ON CONFLICT DO NOTHING', [suiteId, testcaseId]);
}
async function removeCaseFromSuite(suiteId, testcaseId) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    await pgClient.query('DELETE FROM suite_cases WHERE suite_id = $1 AND testcase_id = $2', [suiteId, testcaseId]);
}
async function listCasesInSuite(suiteId) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query('SELECT testcase_id FROM suite_cases WHERE suite_id = $1', [suiteId]);
    return result.rows.map((row) => row.testcase_id);
}
async function suiteCaseCount(suiteId) {
    await (0, pgClient_1.ensurePgConnected)();
    const pgClient = (0, pgClient_1.getPgClient)();
    if (!pgClient) {
        throw new Error('PostgreSQL 클라이언트가 초기화되지 않았습니다.');
    }
    const result = await pgClient.query('SELECT COUNT(*) FROM suite_cases WHERE suite_id = $1', [suiteId]);
    return Number(result.rows[0].count);
}
function rowToSuite(row) {
    return {
        id: row.id,
        releaseId: row.release_id,
        name: row.name,
        description: row.description,
        executor: row.executor,
        environment: row.environment,
        dueDate: row.due_date,
        createdAt: row.created_at,
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0Rlc2t0b3AvbXktcHJvamVjdC9zcmMvbWFpbi9hcHAvZG9tYWlucy9zdWl0ZXMvcmVwb3NpdG9yaWVzL3N1aXRlUmVwb3NpdG9yeS50cyIsIm1hcHBpbmdzIjoiOztBQUdBLGtDQVdDO0FBRUQsa0NBWUM7QUFFRCxrQ0FRQztBQUVELGdDQVFDO0FBRUQsOENBT0M7QUFFRCxrREFPQztBQUVELDRDQVFDO0FBRUQsd0NBUUM7QUF0RkQsd0VBQTJGO0FBR3BGLEtBQUssVUFBVSxXQUFXLENBQUMsSUFBcUM7SUFDckUsTUFBTSxJQUFBLDRCQUFpQixHQUFFLENBQUM7SUFDMUIsTUFBTSxRQUFRLEdBQUcsSUFBQSxzQkFBVyxHQUFFLENBQUM7SUFDL0IsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2QsTUFBTSxJQUFJLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFDRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFFBQVEsQ0FBQyxLQUFLLENBQ2pDLGlJQUFpSSxFQUNqSSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQzdGLENBQUM7SUFDRixPQUFPLFVBQVUsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEMsQ0FBQztBQUVNLEtBQUssVUFBVSxXQUFXLENBQUMsRUFBVSxFQUFFLEtBQXFCO0lBQ2pFLE1BQU0sSUFBQSw0QkFBaUIsR0FBRSxDQUFDO0lBQzFCLE1BQU0sUUFBUSxHQUFHLElBQUEsc0JBQVcsR0FBRSxDQUFDO0lBQy9CLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUNkLE1BQU0sSUFBSSxLQUFLLENBQUMsZ0NBQWdDLENBQUMsQ0FBQztJQUNwRCxDQUFDO0lBQ0QsTUFBTSxNQUFNLEdB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QUFDLENBQUM7SUFDMUcsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEdBQVEsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3hELENBQUM7QUFFTSxLQUFLLFVBQVUsY0FBYyxDQUFDLE9BQWU7SUFDbEQsTUFBTSxJQUFBLDRCQUFpQixHQUFFLENBQUM7SUFDMUIsTUFBTSxRQUFRLEdBQUcsSUFBQSxzQkFBVyxHQUFFLENBQUM7SUFDL0IsSUFBSSxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ2QsTUFBTSxJQUFJLEtBQUssQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDO0lBQ3BELENBQUM7SUFDRCxNQUFNLE1BQU0sR0FBRyxNQUFNLFFBQVEsQ0FBQyxLQUFLLENBQUMsc0RBQXNELEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO0lBQ3ZHLE9BQU8sTUFBTSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVELFNBQVMsVUFBVSxDQUFDLEdBQVE7SUFDMUIsT0FBTztRQUNMLEVBQUUsRUFBRSxHQUFHLENBQUMsRUFBRTtRQUNWLFNBQVMsRUFBRSxHQUFHLENBQUMsVUFBVTtRQUN6QixJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUk7UUFDZCxXQUFXLEVBQUUsR0FBRyxDQUFDLFdBQVc7UUFDNUIsUUFBUSxFQUFFLEdBQUcsQ0FBQyxRQUFRO1FBQ3RCLFdBQVcsRUFBRSxHQUFHLENBQUMsV0FBVztRQUM1QixPQUFPLEVBQUUsR0FBRyxDQUFDLFFBQVE7UUFDckIsU0FBUyxFQUFFLEdBQUcsQ0FBQyxVQUFVO0tBQzFCLENBQUM7QUFDSixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy8zaS1hMS0yMDIxLTAxNy9EZXNrdG9wL215LXByb2plY3Qvc3JjL21haW4vYXBwL2RvbWFpbnMvc3VpdGVzL3JlcG9zaXRvcmllcy9zdWl0ZVJlcG9zaXRvcnkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0UGdDbGllbnQsIGVuc3VyZVBnQ29ubmVjdGVkIH0gZnJvbSAnLi4vLi4vLi4vaW5mcmFzdHJ1Y3R1cmUvZGF0YWJhc2UvcGdDbGllbnQnO1xuaW1wb3J0IHsgU3VpdGUsIFN1aXRlQ2FzZSB9IGZyb20gJy4uL21vZGVscy9TdWl0ZSc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTdWl0ZShkYXRhOiBPbWl0PFN1aXRlLCAnaWQnIHwgJ2NyZWF0ZWRBdCc+KTogUHJvbWlzZTxTdWl0ZT4ge1xuICBhd2FpdCBlbnN1cmVQZ0Nvbm5lY3RlZCgpO1xuICBjb25zdCBwZ0NsaWVudCA9IGdldFBnQ2xpZW50KCk7XG4gIGlmICghcGdDbGllbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bvc3RncmVTUUwg7YG065287J207Ja47Yq46rCAIOy0iOq4sO2ZlOuQmOyngCDslYrslZjsirXri4jri6QuJyk7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGdDbGllbnQucXVlcnkoXG4gICAgYElOU0VSVCBJTlRPIHN1aXRlcyAocmVsZWFzZV9pZCwgbmFtZSwgZGVzY3JpcHRpb24sIGV4ZWN1dG9yLCBlbnZpcm9ubWVudCwgZHVlX2RhdGUpIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCAkNikgUkVUVVJOSU5HICpgLFxuICAgIFtkYXRhLnJlbGVhc2VJZCwgZGF0YS5uYW1lLCBkYXRhLmRlc2NyaXB0aW9uLCBkYXRhLmV4ZWN1dG9yLCBkYXRhLmVudmlyb25tZW50LCBkYXRhLmR1ZURhdGVdXG4gICk7XG4gIHJldHVybiByb3dUb1N1aXRlKHJlc3VsdC5yb3dzWzBdKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVN1aXRlKGlkOiBudW1iZXIsIHBhdGNoOiBQYXJ0aWFsPFN1aXRlPik6IFByb21pc2U8U3VpdGUgfCBudWxsPiB7XG4gIGF3YWl0IGVuc3VyZVBnQ29ubmVjdGVkKCk7XG4gIGNvbnN0IHBnQ2xpZW50ID0gZ2V0UGdDbGllbnQoKTtcbiAgaWYgKCFwZ0NsaWVudCkge1xuICAgIHRocm93IG5ldyBFcnJvcignUG9zdGdyZVNRTCDtgbTrnbzsnbTslrjtirjqsIAg7LSI6riw7ZmU65CY7KeAIOyViuyVmOyKteuLiOuLpC4nKTtcbiAgfVxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBwZ0NsaWVudC5xdWVyeShcbiAgICBgVVBEQVRFIHN1aXRlcyBTRVQgbmFtZT0kMSwgZGVzY3JpcHRpb249JDIsIGV4ZWN1dG9yPSQzLCBlbnZpcm9ubWVudD0kNCwgZHVlX2RhdGU9JDUgV0hFUkUgaWQ9JDYgUkVUVVJOSU5HICpgLFxuICAgIFtwYXRjaC5uYW1lLCBwYXRjaC5kZXNjcmlwdGlvbiwgcGF0Y2guZXhlY3V0b3IsIHBhdGNoLmVudmlyb25tZW50LCBwYXRjaC5kdWVEYXRlLCBpZF1cbiAgKTtcbiAgaWYgKHJlc3VsdC5yb3dzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gIHJldHVybiByb3dUb1N1aXRlKHJlc3VsdC5yb3dzWzBdKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVN1aXRlKGlkOiBudW1iZXIpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgYXdhaXQgZW5zdXJlUGdDb25uZWN0ZWQoKTtcbiAgY29uc3QgcGdDbGllbnQgPSBnZXRQZ0NsaWVudCgpO1xuICBpZiAoIXBnQ2xpZW50KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQb3N0Z3JlU1FMIO2BtOudvOydtOyWuO2KuOqwgCDstIjquLDtmZTrkJjsp4Ag7JWK7JWY7Iq164uI64ukLicpO1xuICB9XG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHBnQ2xpZW50LnF1ZXJ5KCdERUxFVEUgRlJPTSBzdWl0ZXMgV0hFUkUgaWQgPSAkMScsIFtpZF0pO1xuICByZXR1cm4gKHJlc3VsdC5yb3dDb3VudCA/PyAwKSA+IDA7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsaXN0U3VpdGVzKCk6IFByb21pc2U8U3VpdGVbXT4ge1xuICBhd2FpdCBlbnN1cmVQZ0Nvbm5lY3RlZCgpO1xuICBjb25zdCBwZ0NsaWVudCA9IGdldFBnQ2xpZW50KCk7XG4gIGlmICghcGdDbGllbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bvc3RncmVTUUwg7YG065287J207Ja47Yq46rCAIOy0iOq4sO2ZlOuQmOyngCDslYrslZjsirXri4jri6QuJyk7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGdDbGllbnQucXVlcnkoJ1NFTEVDVCAqIEZST00gc3VpdGVzIE9SREVSIEJZIGlkJyk7XG4gIHJldHVybiByZXN1bHQucm93cy5tYXAocm93VG9TdWl0ZSk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhc3NpZ25DYXNlVG9TdWl0ZShzdWl0ZUlkOiBudW1iZXIsIHRlc3RjYXNlSWQ6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBlbnN1cmVQZ0Nvbm5lY3RlZCgpO1xuICBjb25zdCBwZ0NsaWVudCA9IGdldFBnQ2xpZW50KCk7XG4gIGlmICghcGdDbGllbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bvc3RncmVTUUwg7YG065287J207Ja47Yq46rCAIOy0iOq4sO2ZlOuQmOyngCDslYrslZjsirXri4jri6QuJyk7XG4gIH1cbiAgYXdhaXQgcGdDbGllbnQucXVlcnkoJ0lOU0VSVCBJTlRPIHN1aXRlX2Nhc2VzIChzdWl0ZV9pZCwgdGVzdGNhc2VfaWQpIFZBTFVFUyAoJDEsICQyKSBPTiBDT05GTElDVCBETyBOT1RISU5HJywgW3N1aXRlSWQsIHRlc3RjYXNlSWRdKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUNhc2VGcm9tU3VpdGUoc3VpdGVJZDogbnVtYmVyLCB0ZXN0Y2FzZUlkOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgYXdhaXQgZW5zdXJlUGdDb25uZWN0ZWQoKTtcbiAgY29uc3QgcGdDbGllbnQgPSBnZXRQZ0NsaWVudCgpO1xuICBpZiAoIXBnQ2xpZW50KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQb3N0Z3JlU1FMIO2BtOudvOydtOyWuO2KuOqwgCDstIjquLDtmZTrkJjsp4Ag7JWK7JWY7Iq164uI64ukLicpO1xuICB9XG4gIGF3YWl0IHBnQ2xpZW50LnF1ZXJ5KCdERUxFVEUgRlJPTSBzdWl0ZV9jYXNlcyBXSEVSRSBzdWl0ZV9pZCA9ICQxIEFORCB0ZXN0Y2FzZV9pZCA9ICQyJywgW3N1aXRlSWQsIHRlc3RjYXNlSWRdKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RDYXNlc0luU3VpdGUoc3VpdGVJZDogbnVtYmVyKTogUHJvbWlzZTxudW1iZXJbXT4ge1xuICBhd2FpdCBlbnN1cmVQZ0Nvbm5lY3RlZCgpO1xuICBjb25zdCBwZ0NsaWVudCA9IGdldFBnQ2xpZW50KCk7XG4gIGlmICghcGdDbGllbnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1Bvc3RncmVTUUwg7YG065287J207Ja47Yq46rCAIOy0iOq4sO2ZlOuQmOyngCDslYrslZjsirXri4jri6QuJyk7XG4gIH1cbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcGdDbGllbnQucXVlcnkoJ1NFTEVDVCB0ZXN0Y2FzZV9pZCBGUk9NIHN1aXRlX2Nhc2VzIFdIRVJFIHN1aXRlX2lkID0gJDEnLCBbc3VpdGVJZF0pO1xuICByZXR1cm4gcmVzdWx0LnJvd3MubWFwKChyb3c6IGFueSkgPT4gcm93LnRlc3RjYXNlX2lkKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN1aXRlQ2FzZUNvdW50KHN1aXRlSWQ6IG51bWJlcik6IFByb21pc2U8bnVtYmVyPiB7XG4gIGF3YWl0IGVuc3VyZVBnQ29ubmVjdGVkKCk7XG4gIGNvbnN0IHBnQ2xpZW50ID0gZ2V0UGdDbGllbnQoKTtcbiAgaWYgKCFwZ0NsaWVudCkge1xuICAgIHRocm93IG5ldyBFcnJvcignUG9zdGdyZVNRTCDtgbTrnbzsnbTslrjtirjqsIAg7LSI6riw7ZmU65CY7KeAIOyViuyVmOyKteuLiOuLpC4nKTtcbiAgfVxuICBjb25zdCByZXN1bHQgPSBhd2FpdCBwZ0NsaWVudC5xdWVyeSgnU0VMRUNUIENPVU5UKCopIEZST00gc3VpdGVfY2FzZXMgV0hFUkUgc3VpdGVfaWQgPSAkMScsIFtzdWl0ZUlkXSk7XG4gIHJldHVybiBOdW1iZXIocmVzdWx0LnJvd3NbMF0uY291bnQpO1xufVxuXG5mdW5jdGlvbiByb3dUb1N1aXRlKHJvdzogYW55KTogU3VpdGUge1xuICByZXR1cm4ge1xuICAgIGlkOiByb3cuaWQsXG4gICAgcmVsZWFzZUlkOiByb3cucmVsZWFzZV9pZCxcbiAgICBuYW1lOiByb3cubmFtZSxcbiAgICBkZXNjcmlwdGlvbjogcm93LmRlc2NyaXB0aW9uLFxuICAgIGV4ZWN1dG9yOiByb3cuZXhlY3V0b3IsXG4gICAgZW52aXJvbm1lbnQ6IHJvdy5lbnZpcm9ubWVudCxcbiAgICBkdWVEYXRlOiByb3cuZHVlX2RhdGUsXG4gICAgY3JlYXRlZEF0OiByb3cuY3JlYXRlZF9hdCxcbiAgfTtcbn0gIl0sInZlcnNpb24iOjN9