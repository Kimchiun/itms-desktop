0b8f72744f2ce4f5915ab301c2e94ce9
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.clearAdvancedSearchResults = exports.setAdvancedSearchFilters = exports.clearDetail = exports.setSearchParams = exports.createTestCase = exports.deleteSearchPreset = exports.fetchSearchPresets = exports.saveSearchPreset = exports.advancedSearchTestCases = exports.searchTestCases = exports.fetchTestCaseDetail = exports.fetchTestCases = void 0;
const toolkit_1 = require("@reduxjs/toolkit");
const axios_1 = __importDefault(require("../../../utils/axios"));
// showToast 임시 선언 (실제 구현은 공통 유틸로 분리 권장)
function showToast(message, type = 'error') {
    alert(`[${type}] ${message}`);
}
const initialState = {
    list: [],
    detail: null,
    loading: false,
    error: null,
    searchParams: {},
    advancedSearch: {
        filters: {},
        results: null,
        loading: false,
        error: null,
    },
    presets: [],
};
exports.fetchTestCases = (0, toolkit_1.createAsyncThunk)('testcases/fetch', async (_, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.get('/api/testcases');
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '테스트케이스 불러오기 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.fetchTestCaseDetail = (0, toolkit_1.createAsyncThunk)('testcases/fetchDetail', async (id, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.get(`/api/testcases/${id}`);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '상세 불러오기 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.searchTestCases = (0, toolkit_1.createAsyncThunk)('testcases/search', async (query, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.post('/api/testcases/search', query);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '검색 실패', 'error');
        return rejectWithValue(error.message);
    }
});
// 고급 검색
exports.advancedSearchTestCases = (0, toolkit_1.createAsyncThunk)('testcases/advancedSearch', async ({ filters, page = 0, size = 20 }, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.post('/api/testcases/search/advanced', { filters, page, size });
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '고급 검색 실패', 'error');
        return rejectWithValue(error.message);
    }
});
// 검색 프리셋 저장
exports.saveSearchPreset = (0, toolkit_1.createAsyncThunk)('testcases/savePreset', async (preset, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.post('/api/testcases/search/presets', preset);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '프리셋 저장 실패', 'error');
        return rejectWithValue(error.message);
    }
});
// 검색 프리셋 목록 조회
exports.fetchSearchPresets = (0, toolkit_1.createAsyncThunk)('testcases/fetchPresets', async (arg, { rejectWithValue }) => {
    try {
        const params = arg.createdBy ? { createdBy: arg.createdBy } : {};
        const res = await axios_1.default.get('/api/testcases/search/presets', { params });
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '프리셋 목록 불러오기 실패', 'error');
        return rejectWithValue(error.message);
    }
});
// 검색 프리셋 삭제
exports.deleteSearchPreset = (0, toolkit_1.createAsyncThunk)('testcases/deletePreset', async (presetId, { rejectWithValue }) => {
    try {
        await axios_1.default.delete(`/api/testcases/search/presets/${presetId}`);
        return presetId;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '프리셋 삭제 실패', 'error');
        return rejectWithValue(error.message);
    }
});
// 테스트 케이스 생성
exports.createTestCase = (0, toolkit_1.createAsyncThunk)('testcases/create', async (testCaseData, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.post('/api/testcases', testCaseData);
        showToast('테스트 케이스가 성공적으로 생성되었습니다!', 'success');
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '테스트 케이스 생성 실패', 'error');
        return rejectWithValue(error.message);
    }
});
const testCaseSlice = (0, toolkit_1.createSlice)({
    name: 'testcases',
    initialState,
    reducers: {
        setSearchParams(state, action) {
            state.searchParams = action.payload;
        },
        clearDetail(state) {
            state.detail = null;
        },
        setAdvancedSearchFilters(state, action) {
            state.advancedSearch.filters = action.payload;
        },
        clearAdvancedSearchResults(state) {
            state.advancedSearch.results = null;
            state.advancedSearch.error = null;
        },
    },
    extraReducers: builder => {
        builder
            .addCase(exports.fetchTestCases.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.fetchTestCases.fulfilled, (state, action) => { state.loading = false; state.list = action.payload; })
            .addCase(exports.fetchTestCases.rejected, (state, action) => { state.loading = false; state.error = action.error.message || '불러오기 실패'; })
            .addCase(exports.fetchTestCaseDetail.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.fetchTestCaseDetail.fulfilled, (state, action) => { state.loading = false; state.detail = action.payload; })
            .addCase(exports.fetchTestCaseDetail.rejected, (state, action) => { state.loading = false; state.error = action.error.message || '상세 불러오기 실패'; })
            .addCase(exports.searchTestCases.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.searchTestCases.fulfilled, (state, action) => { state.loading = false; state.list = action.payload; })
            .addCase(exports.searchTestCases.rejected, (state, action) => { state.loading = false; state.error = action.error.message || '검색 실패'; })
            // 고급 검색
            .addCase(exports.advancedSearchTestCases.pending, state => {
            state.advancedSearch.loading = true;
            state.advancedSearch.error = null;
        })
            .addCase(exports.advancedSearchTestCases.fulfilled, (state, action) => {
            state.advancedSearch.loading = false;
            state.advancedSearch.results = action.payload;
        })
            .addCase(exports.advancedSearchTestCases.rejected, (state, action) => {
            state.advancedSearch.loading = false;
            state.advancedSearch.error = action.error.message || '고급 검색 실패';
        })
            // 프리셋 저장
            .addCase(exports.saveSearchPreset.fulfilled, (state, action) => {
            state.presets.unshift(action.payload);
        })
            // 프리셋 목록 조회
            .addCase(exports.fetchSearchPresets.fulfilled, (state, action) => {
            state.presets = action.payload;
        })
            // 프리셋 삭제
            .addCase(exports.deleteSearchPreset.fulfilled, (state, action) => {
            state.presets = state.presets.filter(preset => preset.id !== action.payload);
        })
            // 테스트 케이스 생성
            .addCase(exports.createTestCase.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.createTestCase.fulfilled, (state, action) => {
            state.loading = false;
            state.list.unshift(action.payload);
        })
            .addCase(exports.createTestCase.rejected, (state, action) => {
            state.loading = false;
            state.error = action.error.message || '생성 실패';
        });
    },
});
_a = testCaseSlice.actions, exports.setSearchParams = _a.setSearchParams, exports.clearDetail = _a.clearDetail, exports.setAdvancedSearchFilters = _a.setAdvancedSearchFilters, exports.clearAdvancedSearchResults = _a.clearAdvancedSearchResults;
exports.default = testCaseSlice.reducer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0Rlc2t0b3AvbXktcHJvamVjdC9zcmMvcmVuZGVyZXIvZmVhdHVyZXMvVGVzdENhc2VNYW5hZ2VtZW50L3N0b3JlL3Rlc3RDYXNlU2xpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDhDQUFnRjtBQUNoRixpRUFBdUM7QUFFdkMsd0NBQXdDO0FBQ3hDLFNBQVMsU0FBUyxDQUFDLE9BQWUsRUFBRSxPQUFxQyxPQUFPO0lBQzlFLEtBQUssQ0FBQyxJQUFJLElBQUksS0FBSyxPQUFPLEVBQUUsQ0FBQyxDQUFDO0FBQ2hDLENBQUM7QUEwREQsTUFBTSxZQUFZLEdBQWtCO0lBQ2xDLElBQUksRUFBRSxFQUFFO0lBQ1IsTUFBTSxFQUFFLElBQUk7SUFDWixPQUFPLEVBQUUsS0FBSztJQUNkLEtBQUssRUFBRSxJQUFJO0lBQ1gsWUFBWSxFQUFFLEVBQUU7SUFDaEIsY0FBYyxFQUFFO1FBQ2QsT0FBTyxFQUFFLEVBQUU7UUFDWCxPQUFPLEVBQUUsSUFBSTtRQUNiLE9BQU8sRUFBRSxLQUFLO1FBQ2QsS0FBSyxFQUFFLElBQUk7S0FDWjtJQUNELE9BQU8sRUFBRSxFQUFFO0NBQ1osQ0FBQztBQUVXLFFBQUEsY0FBYyxHQUFHLElBQUEsMEJBQWdCLEVBQUMsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUU7SUFDakcsSUFBSSxDQUFDO1FBQ0gsTUFBTSxHQUFHLEdBQUcsTUFBTSxlQUFHLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7UUFDNUMsT0FBTyxHQUFHLENBQUMsSUFBa0IsQ0FBQztJQUNoQyxDQUFDO0lBQUMsT0FBTyxLQUFVLEVBQUUsQ0FBQztRQUNwQixTQUFTLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxJQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksZ0JBQWdCLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDeEYsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVVLFFBQUEsbUJBQW1CLEdBQUcsSUFBQSwwQkFBZ0IsRUFBQyx1QkFBdUIsRUFBRSxLQUFLLEVBQUUsRUFBVSxFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUNySCxJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxNQUFNLGVBQUcsQ0FBQyxHQUFHLENBQUMsa0JBQWtCLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDbEQsT0FBTyxHQUFHLENBQUMsSUFBZ0IsQ0FBQztJQUM5QixDQUFDO0lBQUMsT0FBTyxLQUFVLEVBQUUsQ0FBQztRQUNwQixTQUFTLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxJQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksWUFBWSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ3BGLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN4QyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFVSxRQUFBLGVBQWUsR0FBRyxJQUFBLDBCQUFnQixFQUFDLGtCQUFrQixFQUFFLEtBQUssRUFBRSxLQUFVLEVBQUUsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFO0lBQzVHLElBQUksQ0FBQztRQUNILE1BQU0sR0FBRyxHQUFHLE1BQU0sZUFBRyxDQUFDLElBQUksQ0FBQyx1QkFBdUIsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUMzRCxPQUFPLEdBQUcsQ0FBQyxJQUFrQixDQUFDO0lBQ2hDLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDL0UsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVILFFBQVE7QUFDSyxRQUFBLHVCQUF1QixHQUFHLElBQUEsMEJBQWdCLEVBQ3JELDBCQUEwQixFQUMxQixLQUFLLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxHQUFHLENBQUMsRUFBRSxJQUFJLEdBQUcsRUFBRSxFQUFtRSxFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUMvSCxJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxNQUFNLGVBQUcsQ0FBQyxJQUFJLENBQUMsZ0NBQWdDLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7UUFDdEYsT0FBTyxHQUFHLENBQUMsSUFBb0IsQ0FBQztJQUNsQyxDQUFDO0lBQUMsT0FBTyxLQUFVLEVBQUUsQ0FBQztRQUNwQixTQUFTLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxJQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksVUFBVSxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ2xGLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN4QyxDQUFDO0FBQ0gsQ0FBQyxDQUNGLENBQUM7QUFFRixZQUFZO0FBQ0MsUUFBQSxnQkFBZ0IsR0FBRyxJQUFBLDBCQUFnQixFQUM5QyxzQkFBc0IsRUFDdEIsS0FBSyxFQUFFLE1BQThDLEVBQUUsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFO0lBQzVFLElBQUksQ0FBQztRQUNILE1BQU0sR0FBRyxHQUFHLE1BQU0sZUFBRyxDQUFDLElBQUksQ0FBQywrQkFBK0IsRUFBRSxNQUFNLENBQUMsQ0FBQztRQUNwRSxPQUFPLEdBQUcsQ0FBQyxJQUFvQixDQUFDO0lBQ2xDLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDbkYsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQ0YsQ0FBQztBQUVGLGVBQWU7QUFDRixRQUFBLGtCQUFrQixHQUFHLElBQUEsMEJBQWdCLEVBQ2hELHdCQUF3QixFQUN4QixLQUFLLEVBQUUsR0FBMkIsRUFBRSxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUU7SUFDekQsSUFBSSxDQUFDO1FBQ0gsTUFBTSxNQUFNLEdBQUcsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLEVBQUUsR0FBRyxDQUFDLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDakUsTUFBTSxHQUFHLEdBQUcsTUFBTSxlQUFHLENBQUMsR0FBRyxDQUFDLCtCQUErQixFQUFFLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN2RSxPQUFPLEdBQUcsQ0FBQyxJQUFzQixDQUFDO0lBQ3BDLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxnQkFBZ0IsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN4RixPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztBQUNILENBQUMsQ0FDRixDQUFDO0FBRUYsWUFBWTtBQUNDLFFBQUEsa0JBQWtCLEdBQUcsSUFBQSwwQkFBZ0IsRUFDaEQsd0JBQXdCLEVBQ3hCLEtBQUssRUFBRSxRQUFnQixFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUM5QyxJQUFJLENBQUM7UUFDSCxNQUFNLGVBQUcsQ0FBQyxNQUFNLENBQUMsaUNBQWlDLFFBQVEsRUFBRSxDQUFDLENBQUM7UUFDOUQsT0FBTyxRQUFRLENBQUM7SUFDbEIsQ0FBQztJQUFDLE9BQU8sS0FBVSxFQUFFLENBQUM7UUFDcEIsU0FBUyxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE9BQU8sSUFBSSxLQUFLLENBQUMsT0FBTyxJQUFJLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNuRixPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztBQUNILENBQUMsQ0FDRixDQUFDO0FBRUYsYUFBYTtBQUNBLFFBQUEsY0FBYyxHQUFHLElBQUEsMEJBQWdCLEVBQzVDLGtCQUFrQixFQUNsQixLQUFLLEVBQUUsWUFRTixFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUN4QixJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxNQUFNLGVBQUcsQ0FBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFDM0QsU0FBUyxDQUFDLHlCQUF5QixFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQ2hELE9BQU8sR0FBRyxDQUFDLElBQWdCLENBQUM7SUFDOUIsQ0FBQztJQUFDLE9BQU8sS0FBVSxFQUFFLENBQUM7UUFDcEIsU0FBUyxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE9BQU8sSUFBSSxLQUFLLENBQUMsT0FBTyxJQUFJLGVBQWUsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUN2RixPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztBQUNILENBQUMsQ0FDRixDQUFDO0FBRUYsTUFBTSxhQUFhLEdBQUcsSUFBQSxxQkFBVyxFQUFDO0lBQ2hDLElBQUksRUFBRSxXQUFXO0lBQ2pCLFlBQVk7SUFDWixRQUFRLEVBQUU7UUFDUixlQUFlLENBQUMsS0FBSyxFQUFFLE1BQTBCO1lBQy9DLEtBQUssQ0FBQyxZQUFZLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUN0QyxDQUFDO1FBQ0QsV0FBVyxDQUFDLEtBQUs7WUFDZixLQUFLLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztRQUN0QixDQUFDO1FBQ0Qsd0JBQXdCLENBQUMsS0FBSyxFQUFFLE1BQTJDO1lBQ3pFLEtBQUssQ0FBQyxjQUFjLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7UUFDaEQsQ0FBQztRQUNELDBCQUEwQixDQUFDLEtBQUs7WUFDOUIsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1lBQ3BDLEtBQUssQ0FBQyxjQUFjLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNwQyxDQUFDO0tBQ0Y7SUFDRCxhQUFhLEVBQUUsT0FBTyxDQUFDLEVBQUU7UUFDdkIsT0FBTzthQUNKLE9BQU8sQ0FBQyxzQkFBYyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDdkYsT0FBTyxDQUFDLHNCQUFjLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDN0csT0FBTyxDQUFDLHNCQUFjLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNoSSxPQUFPLENBQUMsMkJBQW1CLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUM1RixPQUFPLENBQUMsMkJBQW1CLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDcEgsT0FBTyxDQUFDLDJCQUFtQixDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDeEksT0FBTyxDQUFDLHVCQUFlLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUN4RixPQUFPLENBQUMsdUJBQWUsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUM5RyxPQUFPLENBQUMsdUJBQWUsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUUsR0FBRyxLQUFLLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2hJLFFBQVE7YUFDUCxPQUFPLENBQUMsK0JBQXVCLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxFQUFFO1lBQ2hELEtBQUssQ0FBQyxjQUFjLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztZQUNwQyxLQUFLLENBQUMsY0FBYyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDcEMsQ0FBQyxDQUFDO2FBQ0QsT0FBTyxDQUFDLCtCQUF1QixDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUM1RCxLQUFLLENBQUMsY0FBYyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDckMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUNoRCxDQUFDLENBQUM7YUFDRCxPQUFPLENBQUMsK0JBQXVCLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQzNELEtBQUssQ0FBQyxjQUFjLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQztZQUNyQyxLQUFLLENBQUMsY0FBYyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxVQUFVLENBQUM7UUFDbEUsQ0FBQyxDQUFDO1lBQ0YsU0FBUzthQUNSLE9BQU8sQ0FBQyx3QkFBZ0IsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDckQsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBQ3hDLENBQUMsQ0FBQztZQUNGLFlBQVk7YUFDWCxPQUFPLENBQUMsMEJBQWtCLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ3ZELEtBQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQztRQUNqQyxDQUFDLENBQUM7WUFDRixTQUFTO2FBQ1IsT0FBTyxDQUFDLDBCQUFrQixDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUN2RCxLQUFLLENBQUMsT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDL0UsQ0FBQyxDQUFDO1lBQ0YsYUFBYTthQUNaLE9BQU8sQ0FBQyxzQkFBYyxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDdkYsT0FBTyxDQUFDLHNCQUFjLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ25ELEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDO1lBQ3RCLEtBQUssQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNyQyxDQUFDLENBQUM7YUFDRCxPQUFPLENBQUMsc0JBQWMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxLQUFLLEVBQUUsTUFBTSxFQUFFLEVBQUU7WUFDbEQsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7WUFDdEIsS0FBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxPQUFPLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0NBQ0YsQ0FBQyxDQUFDO0FBRVUsS0FBeUYsYUFBYSxDQUFDLE9BQU8sRUFBNUcsdUJBQWUsdUJBQUUsbUJBQVcsbUJBQUUsZ0NBQXdCLGdDQUFFLGtDQUEwQixpQ0FBMkI7QUFDNUgsa0JBQWUsYUFBYSxDQUFDLE9BQU8sQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvM2ktYTEtMjAyMS0wMTcvRGVza3RvcC9teS1wcm9qZWN0L3NyYy9yZW5kZXJlci9mZWF0dXJlcy9UZXN0Q2FzZU1hbmFnZW1lbnQvc3RvcmUvdGVzdENhc2VTbGljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVTbGljZSwgY3JlYXRlQXN5bmNUaHVuaywgUGF5bG9hZEFjdGlvbiB9IGZyb20gJ0ByZWR1eGpzL3Rvb2xraXQnO1xuaW1wb3J0IGFwaSBmcm9tICcuLi8uLi8uLi91dGlscy9heGlvcyc7XG5cbi8vIHNob3dUb2FzdCDsnoTsi5wg7ISg7Ja4ICjsi6TsoJwg6rWs7ZiE7J2AIOqzte2GtSDsnKDti7jroZwg67aE66asIOq2jOyepSlcbmZ1bmN0aW9uIHNob3dUb2FzdChtZXNzYWdlOiBzdHJpbmcsIHR5cGU6ICdlcnJvcicgfCAnaW5mbycgfCAnc3VjY2VzcycgPSAnZXJyb3InKSB7XG4gIGFsZXJ0KGBbJHt0eXBlfV0gJHttZXNzYWdlfWApO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRlc3RDYXNlIHtcbiAgaWQ6IG51bWJlcjtcbiAgdGl0bGU6IHN0cmluZztcbiAgcHJlcmVxPzogc3RyaW5nO1xuICBzdGVwczogc3RyaW5nW107XG4gIGV4cGVjdGVkOiBzdHJpbmc7XG4gIHByaW9yaXR5OiAnSGlnaCcgfCAnTWVkaXVtJyB8ICdMb3cnO1xuICB0YWdzOiBzdHJpbmdbXTtcbiAgc3RhdHVzOiAnQWN0aXZlJyB8ICdBcmNoaXZlZCc7XG4gIGNyZWF0ZWRCeTogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWR2YW5jZWRTZWFyY2hGaWx0ZXIge1xuICBmb2xkZXJzPzogc3RyaW5nW107XG4gIHRhZ3M/OiBzdHJpbmdbXTtcbiAgc3RhdHVzPzogKCdBY3RpdmUnIHwgJ0FyY2hpdmVkJylbXTtcbiAgY3JlYXRlZEJ5Pzogc3RyaW5nW107XG4gIHByaW9yaXR5PzogKCdIaWdoJyB8ICdNZWRpdW0nIHwgJ0xvdycpW107XG4gIGRhdGVSYW5nZT86IHtcbiAgICBmcm9tOiBzdHJpbmc7XG4gICAgdG86IHN0cmluZztcbiAgfTtcbiAga2V5d29yZD86IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTZWFyY2hQcmVzZXQge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGZpbHRlcnM6IEFkdmFuY2VkU2VhcmNoRmlsdGVyO1xuICBjcmVhdGVkQnk6IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2VhcmNoUmVzdWx0IHtcbiAgdGVzdENhc2VzOiBUZXN0Q2FzZVtdO1xuICB0b3RhbDogbnVtYmVyO1xuICBoaWdobGlnaHRzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XG59XG5cbmludGVyZmFjZSBUZXN0Q2FzZVN0YXRlIHtcbiAgbGlzdDogVGVzdENhc2VbXTtcbiAgZGV0YWlsOiBUZXN0Q2FzZSB8IG51bGw7XG4gIGxvYWRpbmc6IGJvb2xlYW47XG4gIGVycm9yOiBzdHJpbmcgfCBudWxsO1xuICBzZWFyY2hQYXJhbXM6IGFueTtcbiAgYWR2YW5jZWRTZWFyY2g6IHtcbiAgICBmaWx0ZXJzOiBBZHZhbmNlZFNlYXJjaEZpbHRlcjtcbiAgICByZXN1bHRzOiBTZWFyY2hSZXN1bHQgfCBudWxsO1xuICAgIGxvYWRpbmc6IGJvb2xlYW47XG4gICAgZXJyb3I6IHN0cmluZyB8IG51bGw7XG4gIH07XG4gIHByZXNldHM6IFNlYXJjaFByZXNldFtdO1xufVxuXG5jb25zdCBpbml0aWFsU3RhdGU6IFRlc3RDYXNlU3RhdGUgPSB7XG4gIGxpc3Q6IFtdLFxuICBkZXRhaWw6IG51bGwsXG4gIGxvYWRpbmc6IGZhbHNlLFxuICBlcnJvcjogbnVsbCxcbiAgc2VhcmNoUGFyYW1zOiB7fSxcbiAgYWR2YW5jZWRTZWFyY2g6IHtcbiAgICBmaWx0ZXJzOiB7fSxcbiAgICByZXN1bHRzOiBudWxsLFxuICAgIGxvYWRpbmc6IGZhbHNlLFxuICAgIGVycm9yOiBudWxsLFxuICB9LFxuICBwcmVzZXRzOiBbXSxcbn07XG5cbmV4cG9ydCBjb25zdCBmZXRjaFRlc3RDYXNlcyA9IGNyZWF0ZUFzeW5jVGh1bmsoJ3Rlc3RjYXNlcy9mZXRjaCcsIGFzeW5jIChfLCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLmdldCgnL2FwaS90ZXN0Y2FzZXMnKTtcbiAgICByZXR1cm4gcmVzLmRhdGEgYXMgVGVzdENhc2VbXTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn7YWM7Iqk7Yq47LyA7J207IqkIOu2iOufrOyYpOq4sCDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICB9XG59KTtcblxuZXhwb3J0IGNvbnN0IGZldGNoVGVzdENhc2VEZXRhaWwgPSBjcmVhdGVBc3luY1RodW5rKCd0ZXN0Y2FzZXMvZmV0Y2hEZXRhaWwnLCBhc3luYyAoaWQ6IG51bWJlciwgeyByZWplY3RXaXRoVmFsdWUgfSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5nZXQoYC9hcGkvdGVzdGNhc2VzLyR7aWR9YCk7XG4gICAgcmV0dXJuIHJlcy5kYXRhIGFzIFRlc3RDYXNlO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgc2hvd1RvYXN0KGVycm9yPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlIHx8ICfsg4HshLgg67aI65+s7Jik6riwIOyLpO2MqCcsICdlcnJvcicpO1xuICAgIHJldHVybiByZWplY3RXaXRoVmFsdWUoZXJyb3IubWVzc2FnZSk7XG4gIH1cbn0pO1xuXG5leHBvcnQgY29uc3Qgc2VhcmNoVGVzdENhc2VzID0gY3JlYXRlQXN5bmNUaHVuaygndGVzdGNhc2VzL3NlYXJjaCcsIGFzeW5jIChxdWVyeTogYW55LCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLnBvc3QoJy9hcGkvdGVzdGNhc2VzL3NlYXJjaCcsIHF1ZXJ5KTtcbiAgICByZXR1cm4gcmVzLmRhdGEgYXMgVGVzdENhc2VbXTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn6rKA7IOJIOyLpO2MqCcsICdlcnJvcicpO1xuICAgIHJldHVybiByZWplY3RXaXRoVmFsdWUoZXJyb3IubWVzc2FnZSk7XG4gIH1cbn0pO1xuXG4vLyDqs6DquIkg6rKA7IOJXG5leHBvcnQgY29uc3QgYWR2YW5jZWRTZWFyY2hUZXN0Q2FzZXMgPSBjcmVhdGVBc3luY1RodW5rKFxuICAndGVzdGNhc2VzL2FkdmFuY2VkU2VhcmNoJyxcbiAgYXN5bmMgKHsgZmlsdGVycywgcGFnZSA9IDAsIHNpemUgPSAyMCB9OiB7IGZpbHRlcnM6IEFkdmFuY2VkU2VhcmNoRmlsdGVyOyBwYWdlPzogbnVtYmVyOyBzaXplPzogbnVtYmVyIH0sIHsgcmVqZWN0V2l0aFZhbHVlIH0pID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLnBvc3QoJy9hcGkvdGVzdGNhc2VzL3NlYXJjaC9hZHZhbmNlZCcsIHsgZmlsdGVycywgcGFnZSwgc2l6ZSB9KTtcbiAgICAgIHJldHVybiByZXMuZGF0YSBhcyBTZWFyY2hSZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgc2hvd1RvYXN0KGVycm9yPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlIHx8ICfqs6DquIkg6rKA7IOJIOyLpO2MqCcsICdlcnJvcicpO1xuICAgICAgcmV0dXJuIHJlamVjdFdpdGhWYWx1ZShlcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gIH1cbik7XG5cbi8vIOqygOyDiSDtlITrpqzshYsg7KCA7J6lXG5leHBvcnQgY29uc3Qgc2F2ZVNlYXJjaFByZXNldCA9IGNyZWF0ZUFzeW5jVGh1bmsoXG4gICd0ZXN0Y2FzZXMvc2F2ZVByZXNldCcsXG4gIGFzeW5jIChwcmVzZXQ6IE9taXQ8U2VhcmNoUHJlc2V0LCAnaWQnIHwgJ2NyZWF0ZWRBdCc+LCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wb3N0KCcvYXBpL3Rlc3RjYXNlcy9zZWFyY2gvcHJlc2V0cycsIHByZXNldCk7XG4gICAgICByZXR1cm4gcmVzLmRhdGEgYXMgU2VhcmNoUHJlc2V0O1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn7ZSE66as7IWLIOyggOyepSDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICAgIHJldHVybiByZWplY3RXaXRoVmFsdWUoZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuICB9XG4pO1xuXG4vLyDqsoDsg4kg7ZSE66as7IWLIOuqqeuhnSDsobDtmoxcbmV4cG9ydCBjb25zdCBmZXRjaFNlYXJjaFByZXNldHMgPSBjcmVhdGVBc3luY1RodW5rKFxuICAndGVzdGNhc2VzL2ZldGNoUHJlc2V0cycsXG4gIGFzeW5jIChhcmc6IHsgY3JlYXRlZEJ5Pzogc3RyaW5nIH0sIHsgcmVqZWN0V2l0aFZhbHVlIH0pID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyYW1zID0gYXJnLmNyZWF0ZWRCeSA/IHsgY3JlYXRlZEJ5OiBhcmcuY3JlYXRlZEJ5IH0gOiB7fTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5nZXQoJy9hcGkvdGVzdGNhc2VzL3NlYXJjaC9wcmVzZXRzJywgeyBwYXJhbXMgfSk7XG4gICAgICByZXR1cm4gcmVzLmRhdGEgYXMgU2VhcmNoUHJlc2V0W107XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgc2hvd1RvYXN0KGVycm9yPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlIHx8ICftlITrpqzshYsg66qp66GdIOu2iOufrOyYpOq4sCDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICAgIHJldHVybiByZWplY3RXaXRoVmFsdWUoZXJyb3IubWVzc2FnZSk7XG4gICAgfVxuICB9XG4pO1xuXG4vLyDqsoDsg4kg7ZSE66as7IWLIOyCreygnFxuZXhwb3J0IGNvbnN0IGRlbGV0ZVNlYXJjaFByZXNldCA9IGNyZWF0ZUFzeW5jVGh1bmsoXG4gICd0ZXN0Y2FzZXMvZGVsZXRlUHJlc2V0JyxcbiAgYXN5bmMgKHByZXNldElkOiBzdHJpbmcsIHsgcmVqZWN0V2l0aFZhbHVlIH0pID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgYXBpLmRlbGV0ZShgL2FwaS90ZXN0Y2FzZXMvc2VhcmNoL3ByZXNldHMvJHtwcmVzZXRJZH1gKTtcbiAgICAgIHJldHVybiBwcmVzZXRJZDtcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICBzaG93VG9hc3QoZXJyb3I/LnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlIHx8IGVycm9yLm1lc3NhZ2UgfHwgJ+2UhOumrOyFiyDsgq3soJwg7Iuk7YyoJywgJ2Vycm9yJyk7XG4gICAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuKTtcblxuLy8g7YWM7Iqk7Yq4IOy8gOydtOyKpCDsg53shLFcbmV4cG9ydCBjb25zdCBjcmVhdGVUZXN0Q2FzZSA9IGNyZWF0ZUFzeW5jVGh1bmsoXG4gICd0ZXN0Y2FzZXMvY3JlYXRlJyxcbiAgYXN5bmMgKHRlc3RDYXNlRGF0YToge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBwcmlvcml0eTogJ0hpZ2gnIHwgJ01lZGl1bScgfCAnTG93JztcbiAgICBzdGF0dXM6ICdEcmFmdCcgfCAnQWN0aXZlJyB8ICdJbmFjdGl2ZSc7XG4gICAgc3RlcHM6IHN0cmluZ1tdO1xuICAgIGV4cGVjdGVkUmVzdWx0OiBzdHJpbmc7XG4gICAgdGFnczogc3RyaW5nO1xuICB9LCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wb3N0KCcvYXBpL3Rlc3RjYXNlcycsIHRlc3RDYXNlRGF0YSk7XG4gICAgICBzaG93VG9hc3QoJ+2FjOyKpO2KuCDsvIDsnbTsiqTqsIAg7ISx6rO17KCB7Jy866GcIOyDneyEseuQmOyXiOyKteuLiOuLpCEnLCAnc3VjY2VzcycpO1xuICAgICAgcmV0dXJuIHJlcy5kYXRhIGFzIFRlc3RDYXNlO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn7YWM7Iqk7Yq4IOy8gOydtOyKpCDsg53shLEg7Iuk7YyoJywgJ2Vycm9yJyk7XG4gICAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuKTtcblxuY29uc3QgdGVzdENhc2VTbGljZSA9IGNyZWF0ZVNsaWNlKHtcbiAgbmFtZTogJ3Rlc3RjYXNlcycsXG4gIGluaXRpYWxTdGF0ZSxcbiAgcmVkdWNlcnM6IHtcbiAgICBzZXRTZWFyY2hQYXJhbXMoc3RhdGUsIGFjdGlvbjogUGF5bG9hZEFjdGlvbjxhbnk+KSB7XG4gICAgICBzdGF0ZS5zZWFyY2hQYXJhbXMgPSBhY3Rpb24ucGF5bG9hZDtcbiAgICB9LFxuICAgIGNsZWFyRGV0YWlsKHN0YXRlKSB7XG4gICAgICBzdGF0ZS5kZXRhaWwgPSBudWxsO1xuICAgIH0sXG4gICAgc2V0QWR2YW5jZWRTZWFyY2hGaWx0ZXJzKHN0YXRlLCBhY3Rpb246IFBheWxvYWRBY3Rpb248QWR2YW5jZWRTZWFyY2hGaWx0ZXI+KSB7XG4gICAgICBzdGF0ZS5hZHZhbmNlZFNlYXJjaC5maWx0ZXJzID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgfSxcbiAgICBjbGVhckFkdmFuY2VkU2VhcmNoUmVzdWx0cyhzdGF0ZSkge1xuICAgICAgc3RhdGUuYWR2YW5jZWRTZWFyY2gucmVzdWx0cyA9IG51bGw7XG4gICAgICBzdGF0ZS5hZHZhbmNlZFNlYXJjaC5lcnJvciA9IG51bGw7XG4gICAgfSxcbiAgfSxcbiAgZXh0cmFSZWR1Y2VyczogYnVpbGRlciA9PiB7XG4gICAgYnVpbGRlclxuICAgICAgLmFkZENhc2UoZmV0Y2hUZXN0Q2FzZXMucGVuZGluZywgc3RhdGUgPT4geyBzdGF0ZS5sb2FkaW5nID0gdHJ1ZTsgc3RhdGUuZXJyb3IgPSBudWxsOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hUZXN0Q2FzZXMuZnVsZmlsbGVkLCAoc3RhdGUsIGFjdGlvbikgPT4geyBzdGF0ZS5sb2FkaW5nID0gZmFsc2U7IHN0YXRlLmxpc3QgPSBhY3Rpb24ucGF5bG9hZDsgfSlcbiAgICAgIC5hZGRDYXNlKGZldGNoVGVzdENhc2VzLnJlamVjdGVkLCAoc3RhdGUsIGFjdGlvbikgPT4geyBzdGF0ZS5sb2FkaW5nID0gZmFsc2U7IHN0YXRlLmVycm9yID0gYWN0aW9uLmVycm9yLm1lc3NhZ2UgfHwgJ+u2iOufrOyYpOq4sCDsi6TtjKgnOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hUZXN0Q2FzZURldGFpbC5wZW5kaW5nLCBzdGF0ZSA9PiB7IHN0YXRlLmxvYWRpbmcgPSB0cnVlOyBzdGF0ZS5lcnJvciA9IG51bGw7IH0pXG4gICAgICAuYWRkQ2FzZShmZXRjaFRlc3RDYXNlRGV0YWlsLmZ1bGZpbGxlZCwgKHN0YXRlLCBhY3Rpb24pID0+IHsgc3RhdGUubG9hZGluZyA9IGZhbHNlOyBzdGF0ZS5kZXRhaWwgPSBhY3Rpb24ucGF5bG9hZDsgfSlcbiAgICAgIC5hZGRDYXNlKGZldGNoVGVzdENhc2VEZXRhaWwucmVqZWN0ZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgc3RhdGUuZXJyb3IgPSBhY3Rpb24uZXJyb3IubWVzc2FnZSB8fCAn7IOB7IS4IOu2iOufrOyYpOq4sCDsi6TtjKgnOyB9KVxuICAgICAgLmFkZENhc2Uoc2VhcmNoVGVzdENhc2VzLnBlbmRpbmcsIHN0YXRlID0+IHsgc3RhdGUubG9hZGluZyA9IHRydWU7IHN0YXRlLmVycm9yID0gbnVsbDsgfSlcbiAgICAgIC5hZGRDYXNlKHNlYXJjaFRlc3RDYXNlcy5mdWxmaWxsZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgc3RhdGUubGlzdCA9IGFjdGlvbi5wYXlsb2FkOyB9KVxuICAgICAgLmFkZENhc2Uoc2VhcmNoVGVzdENhc2VzLnJlamVjdGVkLCAoc3RhdGUsIGFjdGlvbikgPT4geyBzdGF0ZS5sb2FkaW5nID0gZmFsc2U7IHN0YXRlLmVycm9yID0gYWN0aW9uLmVycm9yLm1lc3NhZ2UgfHwgJ+qygOyDiSDsi6TtjKgnOyB9KVxuICAgICAgLy8g6rOg6riJIOqygOyDiVxuICAgICAgLmFkZENhc2UoYWR2YW5jZWRTZWFyY2hUZXN0Q2FzZXMucGVuZGluZywgc3RhdGUgPT4geyBcbiAgICAgICAgc3RhdGUuYWR2YW5jZWRTZWFyY2gubG9hZGluZyA9IHRydWU7IFxuICAgICAgICBzdGF0ZS5hZHZhbmNlZFNlYXJjaC5lcnJvciA9IG51bGw7IFxuICAgICAgfSlcbiAgICAgIC5hZGRDYXNlKGFkdmFuY2VkU2VhcmNoVGVzdENhc2VzLmZ1bGZpbGxlZCwgKHN0YXRlLCBhY3Rpb24pID0+IHsgXG4gICAgICAgIHN0YXRlLmFkdmFuY2VkU2VhcmNoLmxvYWRpbmcgPSBmYWxzZTsgXG4gICAgICAgIHN0YXRlLmFkdmFuY2VkU2VhcmNoLnJlc3VsdHMgPSBhY3Rpb24ucGF5bG9hZDsgXG4gICAgICB9KVxuICAgICAgLmFkZENhc2UoYWR2YW5jZWRTZWFyY2hUZXN0Q2FzZXMucmVqZWN0ZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IFxuICAgICAgICBzdGF0ZS5hZHZhbmNlZFNlYXJjaC5sb2FkaW5nID0gZmFsc2U7IFxuICAgICAgICBzdGF0ZS5hZHZhbmNlZFNlYXJjaC5lcnJvciA9IGFjdGlvbi5lcnJvci5tZXNzYWdlIHx8ICfqs6DquIkg6rKA7IOJIOyLpO2MqCc7IFxuICAgICAgfSlcbiAgICAgIC8vIO2UhOumrOyFiyDsoIDsnqVcbiAgICAgIC5hZGRDYXNlKHNhdmVTZWFyY2hQcmVzZXQuZnVsZmlsbGVkLCAoc3RhdGUsIGFjdGlvbikgPT4ge1xuICAgICAgICBzdGF0ZS5wcmVzZXRzLnVuc2hpZnQoYWN0aW9uLnBheWxvYWQpO1xuICAgICAgfSlcbiAgICAgIC8vIO2UhOumrOyFiyDrqqnroZ0g7KGw7ZqMXG4gICAgICAuYWRkQ2FzZShmZXRjaFNlYXJjaFByZXNldHMuZnVsZmlsbGVkLCAoc3RhdGUsIGFjdGlvbikgPT4ge1xuICAgICAgICBzdGF0ZS5wcmVzZXRzID0gYWN0aW9uLnBheWxvYWQ7XG4gICAgICB9KVxuICAgICAgLy8g7ZSE66as7IWLIOyCreygnFxuICAgICAgLmFkZENhc2UoZGVsZXRlU2VhcmNoUHJlc2V0LmZ1bGZpbGxlZCwgKHN0YXRlLCBhY3Rpb24pID0+IHtcbiAgICAgICAgc3RhdGUucHJlc2V0cyA9IHN0YXRlLnByZXNldHMuZmlsdGVyKHByZXNldCA9PiBwcmVzZXQuaWQgIT09IGFjdGlvbi5wYXlsb2FkKTtcbiAgICAgIH0pXG4gICAgICAvLyDthYzsiqTtirgg7LyA7J207IqkIOyDneyEsVxuICAgICAgLmFkZENhc2UoY3JlYXRlVGVzdENhc2UucGVuZGluZywgc3RhdGUgPT4geyBzdGF0ZS5sb2FkaW5nID0gdHJ1ZTsgc3RhdGUuZXJyb3IgPSBudWxsOyB9KVxuICAgICAgLmFkZENhc2UoY3JlYXRlVGVzdENhc2UuZnVsZmlsbGVkLCAoc3RhdGUsIGFjdGlvbikgPT4geyBcbiAgICAgICAgc3RhdGUubG9hZGluZyA9IGZhbHNlOyBcbiAgICAgICAgc3RhdGUubGlzdC51bnNoaWZ0KGFjdGlvbi5wYXlsb2FkKTtcbiAgICAgIH0pXG4gICAgICAuYWRkQ2FzZShjcmVhdGVUZXN0Q2FzZS5yZWplY3RlZCwgKHN0YXRlLCBhY3Rpb24pID0+IHsgXG4gICAgICAgIHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgXG4gICAgICAgIHN0YXRlLmVycm9yID0gYWN0aW9uLmVycm9yLm1lc3NhZ2UgfHwgJ+yDneyEsSDsi6TtjKgnOyBcbiAgICAgIH0pO1xuICB9LFxufSk7XG5cbmV4cG9ydCBjb25zdCB7IHNldFNlYXJjaFBhcmFtcywgY2xlYXJEZXRhaWwsIHNldEFkdmFuY2VkU2VhcmNoRmlsdGVycywgY2xlYXJBZHZhbmNlZFNlYXJjaFJlc3VsdHMgfSA9IHRlc3RDYXNlU2xpY2UuYWN0aW9ucztcbmV4cG9ydCBkZWZhdWx0IHRlc3RDYXNlU2xpY2UucmVkdWNlcjsgIl0sInZlcnNpb24iOjN9