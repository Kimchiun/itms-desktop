109d31998fda5571ffc7b1fe49271771
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generatePerformanceReport = exports.getPerformanceStats = exports.measureOperation = exports.performanceMonitor = void 0;
class PerformanceMonitor {
    constructor() {
        this.metrics = [];
        this.maxMetrics = 1000; // 최대 저장 메트릭 수
    }
    /**
     * 성능 측정을 위한 래퍼 함수
     */
    async measure(operation, fn, metadata) {
        const startTime = performance.now();
        const timestamp = new Date();
        try {
            const result = await fn();
            const duration = performance.now() - startTime;
            this.addMetric({
                operation,
                duration,
                timestamp,
                success: true,
                metadata
            });
            return result;
        }
        catch (error) {
            const duration = performance.now() - startTime;
            this.addMetric({
                operation,
                duration,
                timestamp,
                success: false,
                error: error instanceof Error ? error.message : String(error),
                metadata
            });
            throw error;
        }
    }
    /**
     * 메트릭 추가
     */
    addMetric(metric) {
        this.metrics.push(metric);
        // 최대 메트릭 수를 초과하면 가장 오래된 것부터 제거
        if (this.metrics.length > this.maxMetrics) {
            this.metrics = this.metrics.slice(-this.maxMetrics);
        }
    }
    /**
     * 특정 작업의 통계 반환
     */
    getStats(operation) {
        const filteredMetrics = operation
            ? this.metrics.filter(m => m.operation === operation)
            : this.metrics;
        if (filteredMetrics.length === 0) {
            return {
                totalOperations: 0,
                successfulOperations: 0,
                failedOperations: 0,
                averageDuration: 0,
                minDuration: 0,
                maxDuration: 0
            };
        }
        const successfulMetrics = filteredMetrics.filter(m => m.success);
        const failedMetrics = filteredMetrics.filter(m => !m.success);
        const durations = filteredMetrics.map(m => m.duration);
        return {
            totalOperations: filteredMetrics.length,
            successfulOperations: successfulMetrics.length,
            failedOperations: failedMetrics.length,
            averageDuration: durations.reduce((sum, d) => sum + d, 0) / durations.length,
            minDuration: Math.min(...durations),
            maxDuration: Math.max(...durations),
            lastOperation: filteredMetrics[filteredMetrics.length - 1]
        };
    }
    /**
     * 최근 메트릭 조회
     */
    getRecentMetrics(limit = 10) {
        return this.metrics.slice(-limit);
    }
    /**
     * 성능 경고 체크
     */
    checkPerformanceWarnings(operation) {
        const stats = this.getStats(operation);
        const warnings = [];
        if (stats.averageDuration > 1000) {
            warnings.push(`${operation}: 평균 응답 시간이 1초를 초과합니다 (${stats.averageDuration.toFixed(2)}ms)`);
        }
        if (stats.failedOperations / stats.totalOperations > 0.1) {
            warnings.push(`${operation}: 실패율이 10%를 초과합니다 (${((stats.failedOperations / stats.totalOperations) * 100).toFixed(1)}%)`);
        }
        if (stats.maxDuration > 5000) {
            warnings.push(`${operation}: 최대 응답 시간이 5초를 초과합니다 (${stats.maxDuration.toFixed(2)}ms)`);
        }
        return warnings;
    }
    /**
     * 메트릭 초기화
     */
    clearMetrics() {
        this.metrics = [];
    }
    /**
     * 성능 리포트 생성
     */
    generateReport() {
        const allStats = this.getStats();
        const folderDragDropStats = this.getStats('folder-dragdrop');
        const warnings = this.checkPerformanceWarnings('folder-dragdrop');
        return `
=== 성능 모니터링 리포트 ===
생성 시간: ${new Date().toLocaleString()}

전체 작업 통계:
- 총 작업 수: ${allStats.totalOperations}
- 성공률: ${allStats.totalOperations > 0 ? ((allStats.successfulOperations / allStats.totalOperations) * 100).toFixed(1) : 0}%
- 평균 응답 시간: ${allStats.averageDuration.toFixed(2)}ms

폴더 드래그 앤 드롭 통계:
- 총 작업 수: ${folderDragDropStats.totalOperations}
- 성공률: ${folderDragDropStats.totalOperations > 0 ? ((folderDragDropStats.successfulOperations / folderDragDropStats.totalOperations) * 100).toFixed(1) : 0}%
- 평균 응답 시간: ${folderDragDropStats.averageDuration.toFixed(2)}ms
- 최소 응답 시간: ${folderDragDropStats.minDuration.toFixed(2)}ms
- 최대 응답 시간: ${folderDragDropStats.maxDuration.toFixed(2)}ms

성능 경고:
${warnings.length > 0 ? warnings.map(w => `- ${w}`).join('\n') : '- 없음'}

최근 작업 (최대 5개):
${this.getRecentMetrics(5).map(m => `- ${m.operation}: ${m.success ? '성공' : '실패'} (${m.duration.toFixed(2)}ms) - ${m.timestamp.toLocaleTimeString()}`).join('\n')}
    `.trim();
    }
}
// 싱글톤 인스턴스
exports.performanceMonitor = new PerformanceMonitor();
// 편의 함수들
exports.measureOperation = exports.performanceMonitor.measure.bind(exports.performanceMonitor);
exports.getPerformanceStats = exports.performanceMonitor.getStats.bind(exports.performanceMonitor);
exports.generatePerformanceReport = exports.performanceMonitor.generateReport.bind(exports.performanceMonitor);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0Rlc2t0b3AvbXktcHJvamVjdC9zcmMvbWFpbi9hcHAvdXRpbHMvcGVyZm9ybWFuY2VNb25pdG9yLnRzIiwibWFwcGluZ3MiOiI7OztBQW1CQSxNQUFNLGtCQUFrQjtJQUF4QjtRQUNVLFlBQU8sR0FBd0IsRUFBRSxDQUFDO1FBQ3pCLGVBQVUsR0FBRyxJQUFJLENBQUMsQ0FBQyxjQUFjO0lBNkpwRCxDQUFDO0lBM0pDOztPQUVHO0lBQ0gsS0FBSyxDQUFDLE9BQU8sQ0FDWCxTQUFpQixFQUNqQixFQUFvQixFQUNwQixRQUE4QjtRQUU5QixNQUFNLFNBQVMsR0FBRyxXQUFXLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDcEMsTUFBTSxTQUFTLEdBQUcsSUFBSSxJQUFJLEVBQUUsQ0FBQztRQUU3QixJQUFJLENBQUM7WUFDSCxNQUFNLE1BQU0sR0FBRyxNQUFNLEVBQUUsRUFBRSxDQUFDO1lBQzFCLE1BQU0sUUFBUSxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQUUsR0FBRyxTQUFTLENBQUM7WUFFL0MsSUFBSSxDQUFDLFNBQVMsQ0FBQztnQkFDYixTQUFTO2dCQUNULFFBQVE7Z0JBQ1IsU0FBUztnQkFDVCxPQUFPLEVBQUUsSUFBSTtnQkFDYixRQUFRO2FBQ1QsQ0FBQyxDQUFDO1lBRUgsT0FBTyxNQUFNLENBQUM7UUFDaEIsQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixNQUFNLFFBQVEsR0FBRyxXQUFXLENBQUMsR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFDO1lBRS9DLElBQUksQ0FBQyxTQUFTLENBQUM7Z0JBQ2IsU0FBUztnQkFDVCxRQUFRO2dCQUNSLFNBQVM7Z0JBQ1QsT0FBTyxFQUFFLEtBQUs7Z0JBQ2QsS0FBSyxFQUFFLEtBQUssWUFBWSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUM7Z0JBQzdELFFBQVE7YUFDVCxDQUFDLENBQUM7WUFFSCxNQUFN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T0FBTyxDQUFDLElBQUksQ0FBQywwQkFBa0IsQ0FBQyxDQUFDO0FBQ3ZFLFFBQUEsbUJBQW1CLEdBQUcsMEJBQWtCLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQywwQkFBa0IsQ0FBQyxDQUFDO0FBQzNFLFFBQUEseUJBQXlCLEdBQUcsMEJBQWtCLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQywwQkFBa0IsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy8zaS1hMS0yMDIxLTAxNy9EZXNrdG9wL215LXByb2plY3Qvc3JjL21haW4vYXBwL3V0aWxzL3BlcmZvcm1hbmNlTW9uaXRvci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgUGVyZm9ybWFuY2VNZXRyaWMge1xuICBvcGVyYXRpb246IHN0cmluZztcbiAgZHVyYXRpb246IG51bWJlcjtcbiAgdGltZXN0YW1wOiBEYXRlO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBlcnJvcj86IHN0cmluZztcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5pbnRlcmZhY2UgUGVyZm9ybWFuY2VTdGF0cyB7XG4gIHRvdGFsT3BlcmF0aW9uczogbnVtYmVyO1xuICBzdWNjZXNzZnVsT3BlcmF0aW9uczogbnVtYmVyO1xuICBmYWlsZWRPcGVyYXRpb25zOiBudW1iZXI7XG4gIGF2ZXJhZ2VEdXJhdGlvbjogbnVtYmVyO1xuICBtaW5EdXJhdGlvbjogbnVtYmVyO1xuICBtYXhEdXJhdGlvbjogbnVtYmVyO1xuICBsYXN0T3BlcmF0aW9uPzogUGVyZm9ybWFuY2VNZXRyaWM7XG59XG5cbmNsYXNzIFBlcmZvcm1hbmNlTW9uaXRvciB7XG4gIHByaXZhdGUgbWV0cmljczogUGVyZm9ybWFuY2VNZXRyaWNbXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IG1heE1ldHJpY3MgPSAxMDAwOyAvLyDstZzrjIAg7KCA7J6lIOuplO2KuOumrSDsiJhcblxuICAvKipcbiAgICog7ISx64qlIOy4oeygleydhCDsnITtlZwg656Y7Y28IO2VqOyImFxuICAgKi9cbiAgYXN5bmMgbWVhc3VyZTxUPihcbiAgICBvcGVyYXRpb246IHN0cmluZyxcbiAgICBmbjogKCkgPT4gUHJvbWlzZTxUPixcbiAgICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgKTogUHJvbWlzZTxUPiB7XG4gICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm4oKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIHRoaXMuYWRkTWV0cmljKHtcbiAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBtZXRhZGF0YVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBcbiAgICAgIHRoaXMuYWRkTWV0cmljKHtcbiAgICAgICAgb3BlcmF0aW9uLFxuICAgICAgICBkdXJhdGlvbixcbiAgICAgICAgdGltZXN0YW1wLFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSxcbiAgICAgICAgbWV0YWRhdGFcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog66mU7Yq466atIOy2lOqwgFxuICAgKi9cbiAgcHJpdmF0ZSBhZGRNZXRyaWMobWV0cmljOiBQZXJmb3JtYW5jZU1ldHJpYyk6IHZvaWQge1xuICAgIHRoaXMubWV0cmljcy5wdXNoKG1ldHJpYyk7XG4gICAgXG4gICAgLy8g7LWc64yAIOuplO2KuOumrSDsiJjrpbwg7LSI6rO87ZWY66m0IOqwgOyepSDsmKTrnpjrkJwg6rKD67aA7YSwIOygnOqxsFxuICAgIGlmICh0aGlzLm1ldHJpY3MubGVuZ3RoID4gdGhpcy5tYXhNZXRyaWNzKSB7XG4gICAgICB0aGlzLm1ldHJpY3MgPSB0aGlzLm1ldHJpY3Muc2xpY2UoLXRoaXMubWF4TWV0cmljcyk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIO2KueyglSDsnpHsl4XsnZgg7Ya16rOEIOuwmO2ZmFxuICAgKi9cbiAgZ2V0U3RhdHMob3BlcmF0aW9uPzogc3RyaW5nKTogUGVyZm9ybWFuY2VTdGF0cyB7XG4gICAgY29uc3QgZmlsdGVyZWRNZXRyaWNzID0gb3BlcmF0aW9uIFxuICAgICAgPyB0aGlzLm1ldHJpY3MuZmlsdGVyKG0gPT4gbS5vcGVyYXRpb24gPT09IG9wZXJhdGlvbilcbiAgICAgIDogdGhpcy5tZXRyaWNzO1xuXG4gICAgaWYgKGZpbHRlcmVkTWV0cmljcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsT3BlcmF0aW9uczogMCxcbiAgICAgICAgc3VjY2Vzc2Z1bE9wZXJhdGlvbnM6IDAsXG4gICAgICAgIGZhaWxlZE9wZXJhdGlvbnM6IDAsXG4gICAgICAgIGF2ZXJhZ2VEdXJhdGlvbjogMCxcbiAgICAgICAgbWluRHVyYXRpb246IDAsXG4gICAgICAgIG1heER1cmF0aW9uOiAwXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHN1Y2Nlc3NmdWxNZXRyaWNzID0gZmlsdGVyZWRNZXRyaWNzLmZpbHRlcihtID0+IG0uc3VjY2Vzcyk7XG4gICAgY29uc3QgZmFpbGVkTWV0cmljcyA9IGZpbHRlcmVkTWV0cmljcy5maWx0ZXIobSA9PiAhbS5zdWNjZXNzKTtcbiAgICBjb25zdCBkdXJhdGlvbnMgPSBmaWx0ZXJlZE1ldHJpY3MubWFwKG0gPT4gbS5kdXJhdGlvbik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxPcGVyYXRpb25zOiBmaWx0ZXJlZE1ldHJpY3MubGVuZ3RoLFxuICAgICAgc3VjY2Vzc2Z1bE9wZXJhdGlvbnM6IHN1Y2Nlc3NmdWxNZXRyaWNzLmxlbmd0aCxcbiAgICAgIGZhaWxlZE9wZXJhdGlvbnM6IGZhaWxlZE1ldHJpY3MubGVuZ3RoLFxuICAgICAgYXZlcmFnZUR1cmF0aW9uOiBkdXJhdGlvbnMucmVkdWNlKChzdW0sIGQpID0+IHN1bSArIGQsIDApIC8gZHVyYXRpb25zLmxlbmd0aCxcbiAgICAgIG1pbkR1cmF0aW9uOiBNYXRoLm1pbiguLi5kdXJhdGlvbnMpLFxuICAgICAgbWF4RHVyYXRpb246IE1hdGgubWF4KC4uLmR1cmF0aW9ucyksXG4gICAgICBsYXN0T3BlcmF0aW9uOiBmaWx0ZXJlZE1ldHJpY3NbZmlsdGVyZWRNZXRyaWNzLmxlbmd0aCAtIDFdXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiDstZzqt7wg66mU7Yq466atIOyhsO2ajFxuICAgKi9cbiAgZ2V0UmVjZW50TWV0cmljcyhsaW1pdDogbnVtYmVyID0gMTApOiBQZXJmb3JtYW5jZU1ldHJpY1tdIHtcbiAgICByZXR1cm4gdGhpcy5tZXRyaWNzLnNsaWNlKC1saW1pdCk7XG4gIH1cblxuICAvKipcbiAgICog7ISx64qlIOqyveqzoCDssrTtgaxcbiAgICovXG4gIGNoZWNrUGVyZm9ybWFuY2VXYXJuaW5ncyhvcGVyYXRpb246IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdGF0cyA9IHRoaXMuZ2V0U3RhdHMob3BlcmF0aW9uKTtcbiAgICBjb25zdCB3YXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChzdGF0cy5hdmVyYWdlRHVyYXRpb24gPiAxMDAwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKGAke29wZXJhdGlvbn06IO2Pieq3oCDsnZHri7Ug7Iuc6rCE7J20IDHstIjrpbwg7LSI6rO87ZWp64uI64ukICgke3N0YXRzLmF2ZXJhZ2VEdXJhdGlvbi50b0ZpeGVkKDIpfW1zKWApO1xuICAgIH1cblxuICAgIGlmIChzdGF0cy5mYWlsZWRPcGVyYXRpb25zIC8gc3RhdHMudG90YWxPcGVyYXRpb25zID4gMC4xKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKGAke29wZXJhdGlvbn06IOyLpO2MqOycqOydtCAxMCXrpbwg7LSI6rO87ZWp64uI64ukICgkeygoc3RhdHMuZmFpbGVkT3BlcmF0aW9ucyAvIHN0YXRzLnRvdGFsT3BlcmF0aW9ucykgKiAxMDApLnRvRml4ZWQoMSl9JSlgKTtcbiAgICB9XG5cbiAgICBpZiAoc3RhdHMubWF4RHVyYXRpb24gPiA1MDAwKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKGAke29wZXJhdGlvbn06IOy1nOuMgCDsnZHri7Ug7Iuc6rCE7J20IDXstIjrpbwg7LSI6rO87ZWp64uI64ukICgke3N0YXRzLm1heER1cmF0aW9uLnRvRml4ZWQoMil9bXMpYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHdhcm5pbmdzO1xuICB9XG5cbiAgLyoqXG4gICAqIOuplO2KuOumrSDstIjquLDtmZRcbiAgICovXG4gIGNsZWFyTWV0cmljcygpOiB2b2lkIHtcbiAgICB0aGlzLm1ldHJpY3MgPSBbXTtcbiAgfVxuXG4gIC8qKlxuICAgKiDshLHriqUg66as7Y+s7Yq4IOyDneyEsVxuICAgKi9cbiAgZ2VuZXJhdGVSZXBvcnQoKTogc3RyaW5nIHtcbiAgICBjb25zdCBhbGxTdGF0cyA9IHRoaXMuZ2V0U3RhdHMoKTtcbiAgICBjb25zdCBmb2xkZXJEcmFnRHJvcFN0YXRzID0gdGhpcy5nZXRTdGF0cygnZm9sZGVyLWRyYWdkcm9wJyk7XG4gICAgY29uc3Qgd2FybmluZ3MgPSB0aGlzLmNoZWNrUGVyZm9ybWFuY2VXYXJuaW5ncygnZm9sZGVyLWRyYWdkcm9wJyk7XG5cbiAgICByZXR1cm4gYFxuPT09IOyEseuKpSDrqqjri4jthLDrp4Eg66as7Y+s7Yq4ID09PVxu7IOd7ISxIOyLnOqwhDogJHtuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCl9XG5cbuyghOyytCDsnpHsl4Ug7Ya16rOEOlxuLSDstJ0g7J6R7JeFIOyImDogJHthbGxTdGF0cy50b3RhbE9wZXJhdGlvbnN9XG4tIOyEseqzteuloDogJHthbGxTdGF0cy50b3RhbE9wZXJhdGlvbnMgPiAwID8gKChhbGxTdGF0cy5zdWNjZXNzZnVsT3BlcmF0aW9ucyAvIGFsbFN0YXRzLnRvdGFsT3BlcmF0aW9ucykgKiAxMDApLnRvRml4ZWQoMSkgOiAwfSVcbi0g7Y+J6regIOydkeuLtSDsi5zqsIQ6ICR7YWxsU3RhdHMuYXZlcmFnZUR1cmF0aW9uLnRvRml4ZWQoMil9bXNcblxu7Y+0642UIOuTnOuemOq3uCDslaQg65Oc66GtIO2GteqzhDpcbi0g7LSdIOyekeyXhSDsiJg6ICR7Zm9sZGVyRHJhZ0Ryb3BTdGF0cy50b3RhbE9wZXJhdGlvbnN9XG4tIOyEseqzteuloDogJHtmb2xkZXJEcmFnRHJvcFN0YXRzLnRvdGFsT3BlcmF0aW9ucyA+IDAgPyAoKGZvbGRlckRyYWdEcm9wU3RhdHMuc3VjY2Vzc2Z1bE9wZXJhdGlvbnMgLyBmb2xkZXJEcmFnRHJvcFN0YXRzLnRvdGFsT3BlcmF0aW9ucykgKiAxMDApLnRvRml4ZWQoMSkgOiAwfSVcbi0g7Y+J6regIOydkeuLtSDsi5zqsIQ6ICR7Zm9sZGVyRHJhZ0Ryb3BTdGF0cy5hdmVyYWdlRHVyYXRpb24udG9GaXhlZCgyKX1tc1xuLSDstZzshowg7J2R64u1IOyLnOqwhDogJHtmb2xkZXJEcmFnRHJvcFN0YXRzLm1pbkR1cmF0aW9uLnRvRml4ZWQoMil9bXNcbi0g7LWc64yAIOydkeuLtSDsi5zqsIQ6ICR7Zm9sZGVyRHJhZ0Ryb3BTdGF0cy5tYXhEdXJhdGlvbi50b0ZpeGVkKDIpfW1zXG5cbuyEseuKpSDqsr3qs6A6XG4ke3dhcm5pbmdzLmxlbmd0aCA+IDAgPyB3YXJuaW5ncy5tYXAodyA9PiBgLSAke3d9YCkuam9pbignXFxuJykgOiAnLSDsl4bsnYwnfVxuXG7stZzqt7wg7J6R7JeFICjstZzrjIAgNeqwnCk6XG4ke3RoaXMuZ2V0UmVjZW50TWV0cmljcyg1KS5tYXAobSA9PiBcbiAgYC0gJHttLm9wZXJhdGlvbn06ICR7bS5zdWNjZXNzID8gJ+yEseqztScgOiAn7Iuk7YyoJ30gKCR7bS5kdXJhdGlvbi50b0ZpeGVkKDIpfW1zKSAtICR7bS50aW1lc3RhbXAudG9Mb2NhbGVUaW1lU3RyaW5nKCl9YFxuKS5qb2luKCdcXG4nKX1cbiAgICBgLnRyaW0oKTtcbiAgfVxufVxuXG4vLyDsi7HquIDthqQg7J247Iqk7YS07IqkXG5leHBvcnQgY29uc3QgcGVyZm9ybWFuY2VNb25pdG9yID0gbmV3IFBlcmZvcm1hbmNlTW9uaXRvcigpO1xuXG4vLyDtjrjsnZgg7ZWo7IiY65OkXG5leHBvcnQgY29uc3QgbWVhc3VyZU9wZXJhdGlvbiA9IHBlcmZvcm1hbmNlTW9uaXRvci5tZWFzdXJlLmJpbmQocGVyZm9ybWFuY2VNb25pdG9yKTtcbmV4cG9ydCBjb25zdCBnZXRQZXJmb3JtYW5jZVN0YXRzID0gcGVyZm9ybWFuY2VNb25pdG9yLmdldFN0YXRzLmJpbmQocGVyZm9ybWFuY2VNb25pdG9yKTtcbmV4cG9ydCBjb25zdCBnZW5lcmF0ZVBlcmZvcm1hbmNlUmVwb3J0ID0gcGVyZm9ybWFuY2VNb25pdG9yLmdlbmVyYXRlUmVwb3J0LmJpbmQocGVyZm9ybWFuY2VNb25pdG9yKTsgIl0sInZlcnNpb24iOjN9