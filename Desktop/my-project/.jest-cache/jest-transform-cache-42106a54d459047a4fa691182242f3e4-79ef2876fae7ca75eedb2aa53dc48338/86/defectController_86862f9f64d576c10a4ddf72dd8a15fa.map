{"file":"/Users/3i-a1-2021-017/Desktop/my-project/src/main/app/domains/defects/controllers/defectController.ts","mappings":";;AAAA,qCAAiC;AACjC,6DAAiH;AACjH,qEAAyF;AACzF,uEAAuE;AAEvE,MAAM,MAAM,GAAG,IAAA,gBAAM,GAAE,CAAC;AAExB,WAAW;AACX,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAC/B,IAAI,CAAC;QACD,MAAM,EAAE,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,EAAE,EAAE,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC;QACtE,MAAM,OAAO,GAAG,MAAM,IAAA,2BAAW,EAAC;YAC9B,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC;YAClB,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC;YAClB,MAAM,EAAE,MAAgB;YACxB,QAAQ,EAAE,QAAkB;YAC5B,QAAQ,EAAE,QAAkB;SAC/B,CAAC,CAAC;QACH,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACtB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,qBAAqB,EAAE,KAAK,CAAC,CAAC;QAC5C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,wBAAwB,EAAE,CAAC,CAAC;IAChE,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,WAAW;AACX,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAClC,IAAI,CAAC;QACD,MAAM,MAAM,GAAG,MAAM,IAAA,6BAAa,EAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;QAC1D,IAAI,CAAC,MAAM,EAAE,CAAC;YACV,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;QAC/D,CAAC;QACD,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACrB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC;QAC1C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;IAC7D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ;AACR,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAChC,IAAI,CAAC;QACD,MAAM,MAAM,GAAG,MAAM,IAAA,4BAAY,EAAC;YAC9B,GAAG,GAAG,CAAC,IAAI;YACX,SAAS,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,IAAI,QAAQ;SAC5C,CAAC,CAAC;QACH,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACjC,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC,CAAC;QAC7C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;IAC7D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ;AACR,MAAM,CAAC,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAClC,IAAI,CAAC;QACD,MAAM,MAAM,GAAG,MAAM,IAAA,4BAAY,EAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;YACrD,GAAG,GAAG,CAAC,IAAI;YACX,SAAS,EAAE,GAAG,CAAC,IAAI,CAAC,SAAS,IAAI,QAAQ;SAC5C,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,EAAE,CAAC;YACV,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;QAC/D,CAAC;QACD,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACrB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC,CAAC;QAC7C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;IAC7D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ;AACR,MAAM,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IACrC,IAAI,CAAC;QACD,MAAM,OAAO,GAAG,MAAM,IAAA,4BAAY,EAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;QAC1D,IAAI,CAAC,OAAO,EAAE,CAAC;YACX,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,gBAAgB,EAAE,CAAC,CAAC;QAC/D,CAAC;QACD,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;IAC3B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,sBAAsB,EAAE,KAAK,CAAC,CAAC;QAC7C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,qBAAqB,EAAE,CAAC,CAAC;IAC7D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,gBAAgB;AAChB,MAAM,CAAC,GAAG,CAAC,kBAAkB,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAC9C,IAAI,CAAC;QACD,MAAM,WAAW,GAAG,MAAM,IAAA,wCAAoB,EAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;QACtE,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC1B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,wBAAwB,EAAE,KAAK,CAAC,CAAC;QAC/C,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,uBAAuB,EAAE,CAAC,CAAC;IAC/D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,YAAY;AACZ,MAAM,CAAC,GAAG,CAAC,gCAAgC,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAC5D,IAAI,CAAC;QACD,MAAM,EAAE,UAAU,EAAE,QAAQ,EAAE,WAAW,EAAE,GAAG,MAAM,IAAA,sCAAkB,EAClE,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EACrB,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,YAAY,CAAC,CAClC,CAAC;QAEF,GAAG,CAAC,SAAS,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC;QAC3C,GAAG,CAAC,SAAS,CAAC,qBAAqB,EAAE,yBAAyB,QAAQ,GAAG,CAAC,CAAC;QAC3E,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACzB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,4BAA4B,EAAE,KAAK,CAAC,CAAC;QACnD,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,kBAAkB,EAAE,CAAC,CAAC;IAC1D,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,cAAc;AACd,MAAM,CAAC,GAAG,CAAC,oBAAoB,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE;IAChD,IAAI,CAAC;QACD,MAAM,EAAE,IAAI,GAAG,CAAC,EAAE,IAAI,GAAG,EAAE,EAAE,SAAS,EAAE,YAAY,EAAE,IAAI,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC;QACzE,MAAM,IAAI,GAAG,MAAM,IAAA,0CAAqB,EAAC,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;YAC5D,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC;YAClB,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC;YAClB,SAAS,EAAE,SAAmB;YAC9B,YAAY,EAAE,YAAsB;YACpC,IAAI,EAAE,IAAc;SACvB,CAAC,CAAC;QACH,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACnB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACb,OAAO,CAAC,KAAK,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;QACjD,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,wBAAwB,EAAE,CAAC,CAAC;IAChE,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,kBAAe,MAAM,CAAC","names":[],"sources":["/Users/3i-a1-2021-017/Desktop/my-project/src/main/app/domains/defects/controllers/defectController.ts"],"sourcesContent":["import { Router } from 'express';\nimport { createDefect, updateDefect, deleteDefect, getDefectById, listDefects } from '../services/defectService';\nimport { getDefectAttachments, downloadAttachment } from '../services/attachmentService';\nimport { getDefectActivityLogs } from '../services/activityLogService';\n\nconst router = Router();\n\n// 결함 목록 조회\nrouter.get('/', async (req, res) => {\n    try {\n        const { page = 0, size = 20, status, priority, assignee } = req.query;\n        const defects = await listDefects({\n            page: Number(page),\n            size: Number(size),\n            status: status as string,\n            priority: priority as string,\n            assignee: assignee as string\n        });\n        res.json(defects);\n    } catch (error) {\n        console.error('List defects error:', error);\n        res.status(500).json({ message: '결함 목록 조회 중 오류가 발생했습니다.' });\n    }\n});\n\n// 결함 상세 조회\nrouter.get('/:id', async (req, res) => {\n    try {\n        const defect = await getDefectById(Number(req.params.id));\n        if (!defect) {\n            return res.status(404).json({ message: '결함을 찾을 수 없습니다.' });\n        }\n        res.json(defect);\n    } catch (error) {\n        console.error('Get defect error:', error);\n        res.status(500).json({ message: '결함 조회 중 오류가 발생했습니다.' });\n    }\n});\n\n// 결함 생성\nrouter.post('/', async (req, res) => {\n    try {\n        const defect = await createDefect({\n            ...req.body,\n            createdBy: req.body.createdBy || 'system'\n        });\n        res.status(201).json(defect);\n    } catch (error) {\n        console.error('Create defect error:', error);\n        res.status(500).json({ message: '결함 생성 중 오류가 발생했습니다.' });\n    }\n});\n\n// 결함 수정\nrouter.put('/:id', async (req, res) => {\n    try {\n        const defect = await updateDefect(Number(req.params.id), {\n            ...req.body,\n            updatedBy: req.body.updatedBy || 'system'\n        });\n        if (!defect) {\n            return res.status(404).json({ message: '결함을 찾을 수 없습니다.' });\n        }\n        res.json(defect);\n    } catch (error) {\n        console.error('Update defect error:', error);\n        res.status(500).json({ message: '결함 수정 중 오류가 발생했습니다.' });\n    }\n});\n\n// 결함 삭제\nrouter.delete('/:id', async (req, res) => {\n    try {\n        const success = await deleteDefect(Number(req.params.id));\n        if (!success) {\n            return res.status(404).json({ message: '결함을 찾을 수 없습니다.' });\n        }\n        res.status(204).send();\n    } catch (error) {\n        console.error('Delete defect error:', error);\n        res.status(500).json({ message: '결함 삭제 중 오류가 발생했습니다.' });\n    }\n});\n\n// 결함 첨부파일 목록 조회\nrouter.get('/:id/attachments', async (req, res) => {\n    try {\n        const attachments = await getDefectAttachments(Number(req.params.id));\n        res.json(attachments);\n    } catch (error) {\n        console.error('Get attachments error:', error);\n        res.status(500).json({ message: '첨부파일 조회 중 오류가 발생했습니다.' });\n    }\n});\n\n// 첨부파일 다운로드\nrouter.get('/:id/attachments/:attachmentId', async (req, res) => {\n    try {\n        const { fileStream, filename, contentType } = await downloadAttachment(\n            Number(req.params.id),\n            Number(req.params.attachmentId)\n        );\n        \n        res.setHeader('Content-Type', contentType);\n        res.setHeader('Content-Disposition', `attachment; filename=\"${filename}\"`);\n        fileStream.pipe(res);\n    } catch (error) {\n        console.error('Download attachment error:', error);\n        res.status(404).json({ message: '첨부파일을 찾을 수 없습니다.' });\n    }\n});\n\n// 결함 활동 로그 조회\nrouter.get('/:id/activity-logs', async (req, res) => {\n    try {\n        const { page = 0, size = 20, dateRange, activityType, user } = req.query;\n        const logs = await getDefectActivityLogs(Number(req.params.id), {\n            page: Number(page),\n            size: Number(size),\n            dateRange: dateRange as string,\n            activityType: activityType as string,\n            user: user as string\n        });\n        res.json(logs);\n    } catch (error) {\n        console.error('Get activity logs error:', error);\n        res.status(500).json({ message: '활동 로그 조회 중 오류가 발생했습니다.' });\n    }\n});\n\nexport default router; "],"version":3}