ed7a2941f2fd95b7abef06db610cc876
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.deleteRelease = exports.updateRelease = exports.createRelease = exports.fetchSuites = exports.fetchReleases = void 0;
const toolkit_1 = require("@reduxjs/toolkit");
const axios_1 = __importDefault(require("../../../utils/axios"));
// showToast 임시 선언 (실제 구현은 공통 유틸로 분리 권장)
function showToast(message, type = 'error') {
    alert(`[${type}] ${message}`);
}
const initialState = {
    releases: [],
    suites: [],
    loading: false,
    error: null,
};
exports.fetchReleases = (0, toolkit_1.createAsyncThunk)('releases/fetch', async (_, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.get('/api/releases');
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '릴리즈 불러오기 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.fetchSuites = (0, toolkit_1.createAsyncThunk)('suites/fetch', async (releaseId, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.get(`/api/releases/${releaseId}/suites`);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '스위트 불러오기 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.createRelease = (0, toolkit_1.createAsyncThunk)('releases/create', async (data, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.post('/api/releases', data);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '릴리즈 생성 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.updateRelease = (0, toolkit_1.createAsyncThunk)('releases/update', async ({ id, data }, { rejectWithValue }) => {
    try {
        const res = await axios_1.default.put(`/api/releases/${id}`, data);
        return res.data;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '릴리즈 수정 실패', 'error');
        return rejectWithValue(error.message);
    }
});
exports.deleteRelease = (0, toolkit_1.createAsyncThunk)('releases/delete', async (id, { rejectWithValue }) => {
    try {
        await axios_1.default.delete(`/api/releases/${id}`);
        return id;
    }
    catch (error) {
        showToast(error?.response?.data?.message || error.message || '릴리즈 삭제 실패', 'error');
        return rejectWithValue(error.message);
    }
});
const releaseSlice = (0, toolkit_1.createSlice)({
    name: 'release',
    initialState,
    reducers: {},
    extraReducers: builder => {
        builder
            .addCase(exports.fetchReleases.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.fetchReleases.fulfilled, (state, action) => { state.loading = false; state.releases = action.payload; })
            .addCase(exports.fetchReleases.rejected, (state, action) => { state.loading = false; state.error = action.error.message || '릴리즈 불러오기 실패'; })
            .addCase(exports.fetchSuites.pending, state => { state.loading = true; state.error = null; })
            .addCase(exports.fetchSuites.fulfilled, (state, action) => { state.loading = false; state.suites = action.payload; })
            .addCase(exports.fetchSuites.rejected, (state, action) => { state.loading = false; state.error = action.error.message || '스위트 불러오기 실패'; })
            // 릴리즈 생성
            .addCase(exports.createRelease.fulfilled, (state, action) => { state.releases.push(action.payload); })
            // 릴리즈 수정
            .addCase(exports.updateRelease.fulfilled, (state, action) => {
            const idx = state.releases.findIndex(r => r.id === action.payload.id);
            if (idx !== -1)
                state.releases[idx] = action.payload;
        })
            // 릴리즈 삭제
            .addCase(exports.deleteRelease.fulfilled, (state, action) => {
            state.releases = state.releases.filter(r => r.id !== action.payload);
        });
    },
});
exports.default = releaseSlice.reducer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0Rlc2t0b3AvbXktcHJvamVjdC9zcmMvcmVuZGVyZXIvZmVhdHVyZXMvUmVsZWFzZVBsYW5uaW5nL3N0b3JlL3JlbGVhc2VTbGljZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSw4Q0FBZ0Y7QUFDaEYsaUVBQXVDO0FBRXZDLHdDQUF3QztBQUN4QyxTQUFTLFNBQVMsQ0FBQyxPQUFlLEVBQUUsT0FBcUMsT0FBTztJQUM5RSxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssT0FBTyxFQUFFLENBQUMsQ0FBQztBQUNoQyxDQUFDO0FBNEJELE1BQU0sWUFBWSxHQUFpQjtJQUNqQyxRQUFRLEVBQUUsRUFBRTtJQUNaLE1BQU0sRUFBRSxFQUFFO0lBQ1YsT0FBTyxFQUFFLEtBQUs7SUFDZCxLQUFLLEVBQUUsSUFBSTtDQUNaLENBQUM7QUFFVyxRQUFBLGFBQWEsR0FBRyxJQUFBLDBCQUFnQixFQUFDLGdCQUFnQixFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFO0lBQy9GLElBQUksQ0FBQztRQUNILE1BQU0sR0FBRyxHQUFHLE1BQU0sZUFBRyxDQUFDLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQztRQUMzQyxPQUFPLEdBQUcsQ0FBQyxJQUFpQixDQUFDO0lBQy9CLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDckYsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUNVLFFBQUEsV0FBVyxHQUFHLElBQUEsMEJBQWdCLEVBQUMsY0FBYyxFQUFFLEtBQUssRUFBRSxTQUFpQixFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUMzRyxJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxNQUFNLGVBQUcsQ0FBQyxHQUFHLENBQUMsaUJBQWlCLFNBQVMsU0FBUyxDQUFDLENBQUM7UUFDL0QsT0FBTyxHQUFHLENBQUMsSUFBZSxDQUFDO0lBQzdCLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxhQUFhLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDckYsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUVVLFFBQUEsYUFBYSxHQUFHLElBQUEsMEJBQWdCLEVBQUMsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLElBQXVDLEVBQUUsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFO0lBQ3RJLElBQUksQ0FBQztRQUNILE1BQU0sR0FBRyxHQUFHLE1BQU0sZUFBRyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEQsT0FBTyxHQUFHLENBQUMsSUFBZSxDQUFDO0lBQzdCLENBQUM7SUFBQyxPQUFPLEtBQVUsRUFBRSxDQUFDO1FBQ3BCLFNBQVMsQ0FBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxPQUFPLElBQUksS0FBSyxDQUFDLE9BQU8sSUFBSSxXQUFXLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDbkYsT0FBTyxlQUFlLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3hDLENBQUM7QUFDSCxDQUFDLENBQUMsQ0FBQztBQUNVLFFBQUEsYUFBYSxHQUFHLElBQUEsMEJBQWdCLEVBQUMsaUJBQWlCLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBb0UsRUFBRSxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUU7SUFDN0ssSUFBSSxDQUFDO1FBQ0gsTUFBTSxHQUFHLEdBQUcsTUFBTSxlQUFHLENBQUMsR0FBRyxDQUFDLGlCQUFpQixFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN2RCxPQUFPLEdBQUcsQ0FBQyxJQUFlLENBQUM7SUFDN0IsQ0FBQztJQUFDLE9BQU8sS0FBVSxFQUFFLENBQUM7UUFDcEIsU0FBUyxDQUFDLEtBQUssRUFBRSxRQUFRLEVBQUUsSUFBSSxFQUFFLE9BQU8sSUFBSSxLQUFLLENBQUMsT0FBTyxJQUFJLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNuRixPQUFPLGVBQWUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDeEMsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFDO0FBQ1UsUUFBQSxhQUFhLEdBQUcsSUFBQSwwQkFBZ0IsRUFBQyxpQkFBaUIsRUFBRSxLQUFLLEVBQUUsRUFBVSxFQUFFLEVBQUUsZUFBZSxFQUFFLEVBQUUsRUFBRTtJQUN6RyxJQUFJLENBQUM7UUFDSCxNQUFNLGVBQUcsQ0FBQyxNQUFNLENBQUMsaUJBQWlCLEVBQUUsRUFBRSxDQUFDLENBQUM7UUFDeEMsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0lBQUMsT0FBTyxLQUFVLEVBQUUsQ0FBQztRQUNwQixTQUFTLENBQUMsS0FBSyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxJQUFJLEtBQUssQ0FBQyxPQUFPLElBQUksV0FBVyxFQUFFLE9BQU8sQ0FBQyxDQUFDO1FBQ25GLE9BQU8sZUFBZSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUN4QyxDQUFDO0FBQ0gsQ0FBQyxDQUFDLENBQUM7QUFFSCxNQUFNLFlBQVksR0FBRyxJQUFBLHFCQUFXLEVBQUM7SUFDL0IsSUFBSSxFQUFFLFNBQVM7SUFDZixZQUFZO0lBQ1osUUFBUSxFQUFFLEVBQUU7SUFDWixhQUFhLEVBQUUsT0FBTyxDQUFDLEVBQUU7UUFDdkIsT0FBTzthQUNKLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLE9BQU8sRUFBRSxLQUFLLENBQUMsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDdEYsT0FBTyxDQUFDLHFCQUFhLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDaEgsT0FBTyxDQUFDLHFCQUFhLENBQUMsUUFBUSxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFLEdBQUcsS0FBSyxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxJQUFJLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUNuSSxPQUFPLENBQUMsbUJBQVcsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLEVBQUUsR0FBRyxLQUFLLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3BGLE9BQU8sQ0FBQyxtQkFBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO2FBQzVHLE9BQU8sQ0FBQyxtQkFBVyxDQUFDLFFBQVEsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxPQUFPLEdBQUcsS0FBSyxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sSUFBSSxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDbEksU0FBUzthQUNSLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM5RixTQUFTO2FBQ1IsT0FBTyxDQUFDLHFCQUFhLENBQUMsU0FBUyxFQUFFLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxFQUFFO1lBQ2xELE1BQU0sR0FBRyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1lBQ3RFLElBQUksR0FBRyxLQUFLLENBQUMsQ0FBQztnQkFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7UUFDdkQsQ0FBQyxDQUFDO1lBQ0YsU0FBUzthQUNSLE9BQU8sQ0FBQyxxQkFBYSxDQUFDLFNBQVMsRUFBRSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsRUFBRTtZQUNsRCxLQUFLLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsS0FBSyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDdkUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDO0NBQ0YsQ0FBQyxDQUFDO0FBRUgsa0JBQWUsWUFBWSxDQUFDLE9BQU8sQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvM2ktYTEtMjAyMS0wMTcvRGVza3RvcC9teS1wcm9qZWN0L3NyYy9yZW5kZXJlci9mZWF0dXJlcy9SZWxlYXNlUGxhbm5pbmcvc3RvcmUvcmVsZWFzZVNsaWNlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZVNsaWNlLCBjcmVhdGVBc3luY1RodW5rLCBQYXlsb2FkQWN0aW9uIH0gZnJvbSAnQHJlZHV4anMvdG9vbGtpdCc7XG5pbXBvcnQgYXBpIGZyb20gJy4uLy4uLy4uL3V0aWxzL2F4aW9zJztcblxuLy8gc2hvd1RvYXN0IOyehOyLnCDshKDslrggKOyLpOygnCDqtaztmITsnYAg6rO17Ya1IOycoO2LuOuhnCDrtoTrpqwg6raM7J6lKVxuZnVuY3Rpb24gc2hvd1RvYXN0KG1lc3NhZ2U6IHN0cmluZywgdHlwZTogJ2Vycm9yJyB8ICdpbmZvJyB8ICdzdWNjZXNzJyA9ICdlcnJvcicpIHtcbiAgYWxlcnQoYFske3R5cGV9XSAke21lc3NhZ2V9YCk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVsZWFzZSB7XG4gIGlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIHN0YXJ0RGF0ZT86IHN0cmluZztcbiAgZW5kRGF0ZT86IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5leHBvcnQgaW50ZXJmYWNlIFN1aXRlIHtcbiAgaWQ6IG51bWJlcjtcbiAgcmVsZWFzZUlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gIGV4ZWN1dG9yPzogc3RyaW5nO1xuICBlbnZpcm9ubWVudD86IHN0cmluZztcbiAgZHVlRGF0ZT86IHN0cmluZztcbiAgY3JlYXRlZEF0OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVsZWFzZVN0YXRlIHtcbiAgcmVsZWFzZXM6IFJlbGVhc2VbXTtcbiAgc3VpdGVzOiBTdWl0ZVtdO1xuICBsb2FkaW5nOiBib29sZWFuO1xuICBlcnJvcjogc3RyaW5nIHwgbnVsbDtcbn1cblxuY29uc3QgaW5pdGlhbFN0YXRlOiBSZWxlYXNlU3RhdGUgPSB7XG4gIHJlbGVhc2VzOiBbXSxcbiAgc3VpdGVzOiBbXSxcbiAgbG9hZGluZzogZmFsc2UsXG4gIGVycm9yOiBudWxsLFxufTtcblxuZXhwb3J0IGNvbnN0IGZldGNoUmVsZWFzZXMgPSBjcmVhdGVBc3luY1RodW5rKCdyZWxlYXNlcy9mZXRjaCcsIGFzeW5jIChfLCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLmdldCgnL2FwaS9yZWxlYXNlcycpO1xuICAgIHJldHVybiByZXMuZGF0YSBhcyBSZWxlYXNlW107XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBzaG93VG9hc3QoZXJyb3I/LnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlIHx8IGVycm9yLm1lc3NhZ2UgfHwgJ+umtOumrOymiCDrtojrn6zsmKTquLAg7Iuk7YyoJywgJ2Vycm9yJyk7XG4gICAgcmV0dXJuIHJlamVjdFdpdGhWYWx1ZShlcnJvci5tZXNzYWdlKTtcbiAgfVxufSk7XG5leHBvcnQgY29uc3QgZmV0Y2hTdWl0ZXMgPSBjcmVhdGVBc3luY1RodW5rKCdzdWl0ZXMvZmV0Y2gnLCBhc3luYyAocmVsZWFzZUlkOiBudW1iZXIsIHsgcmVqZWN0V2l0aFZhbHVlIH0pID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXMgPSBhd2FpdCBhcGkuZ2V0KGAvYXBpL3JlbGVhc2VzLyR7cmVsZWFzZUlkfS9zdWl0ZXNgKTtcbiAgICByZXR1cm4gcmVzLmRhdGEgYXMgU3VpdGVbXTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn7Iqk7JyE7Yq4IOu2iOufrOyYpOq4sCDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICB9XG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVJlbGVhc2UgPSBjcmVhdGVBc3luY1RodW5rKCdyZWxlYXNlcy9jcmVhdGUnLCBhc3luYyAoZGF0YTogT21pdDxSZWxlYXNlLCAnaWQnIHwgJ2NyZWF0ZWRBdCc+LCB7IHJlamVjdFdpdGhWYWx1ZSB9KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgYXBpLnBvc3QoJy9hcGkvcmVsZWFzZXMnLCBkYXRhKTtcbiAgICByZXR1cm4gcmVzLmRhdGEgYXMgUmVsZWFzZTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn66a066as7KaIIOyDneyEsSDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICB9XG59KTtcbmV4cG9ydCBjb25zdCB1cGRhdGVSZWxlYXNlID0gY3JlYXRlQXN5bmNUaHVuaygncmVsZWFzZXMvdXBkYXRlJywgYXN5bmMgKHsgaWQsIGRhdGEgfTogeyBpZDogbnVtYmVyOyBkYXRhOiBQYXJ0aWFsPE9taXQ8UmVsZWFzZSwgJ2lkJyB8ICdjcmVhdGVkQXQnPj4gfSwgeyByZWplY3RXaXRoVmFsdWUgfSkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wdXQoYC9hcGkvcmVsZWFzZXMvJHtpZH1gLCBkYXRhKTtcbiAgICByZXR1cm4gcmVzLmRhdGEgYXMgUmVsZWFzZTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHNob3dUb2FzdChlcnJvcj8ucmVzcG9uc2U/LmRhdGE/Lm1lc3NhZ2UgfHwgZXJyb3IubWVzc2FnZSB8fCAn66a066as7KaIIOyImOyglSDsi6TtjKgnLCAnZXJyb3InKTtcbiAgICByZXR1cm4gcmVqZWN0V2l0aFZhbHVlKGVycm9yLm1lc3NhZ2UpO1xuICB9XG59KTtcbmV4cG9ydCBjb25zdCBkZWxldGVSZWxlYXNlID0gY3JlYXRlQXN5bmNUaHVuaygncmVsZWFzZXMvZGVsZXRlJywgYXN5bmMgKGlkOiBudW1iZXIsIHsgcmVqZWN0V2l0aFZhbHVlIH0pID0+IHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBhcGkuZGVsZXRlKGAvYXBpL3JlbGVhc2VzLyR7aWR9YCk7XG4gICAgcmV0dXJuIGlkO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgc2hvd1RvYXN0KGVycm9yPy5yZXNwb25zZT8uZGF0YT8ubWVzc2FnZSB8fCBlcnJvci5tZXNzYWdlIHx8ICfrprTrpqzspogg7IKt7KCcIOyLpO2MqCcsICdlcnJvcicpO1xuICAgIHJldHVybiByZWplY3RXaXRoVmFsdWUoZXJyb3IubWVzc2FnZSk7XG4gIH1cbn0pO1xuXG5jb25zdCByZWxlYXNlU2xpY2UgPSBjcmVhdGVTbGljZSh7XG4gIG5hbWU6ICdyZWxlYXNlJyxcbiAgaW5pdGlhbFN0YXRlLFxuICByZWR1Y2Vyczoge30sXG4gIGV4dHJhUmVkdWNlcnM6IGJ1aWxkZXIgPT4ge1xuICAgIGJ1aWxkZXJcbiAgICAgIC5hZGRDYXNlKGZldGNoUmVsZWFzZXMucGVuZGluZywgc3RhdGUgPT4geyBzdGF0ZS5sb2FkaW5nID0gdHJ1ZTsgc3RhdGUuZXJyb3IgPSBudWxsOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hSZWxlYXNlcy5mdWxmaWxsZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgc3RhdGUucmVsZWFzZXMgPSBhY3Rpb24ucGF5bG9hZDsgfSlcbiAgICAgIC5hZGRDYXNlKGZldGNoUmVsZWFzZXMucmVqZWN0ZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgc3RhdGUuZXJyb3IgPSBhY3Rpb24uZXJyb3IubWVzc2FnZSB8fCAn66a066as7KaIIOu2iOufrOyYpOq4sCDsi6TtjKgnOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hTdWl0ZXMucGVuZGluZywgc3RhdGUgPT4geyBzdGF0ZS5sb2FkaW5nID0gdHJ1ZTsgc3RhdGUuZXJyb3IgPSBudWxsOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hTdWl0ZXMuZnVsZmlsbGVkLCAoc3RhdGUsIGFjdGlvbikgPT4geyBzdGF0ZS5sb2FkaW5nID0gZmFsc2U7IHN0YXRlLnN1aXRlcyA9IGFjdGlvbi5wYXlsb2FkOyB9KVxuICAgICAgLmFkZENhc2UoZmV0Y2hTdWl0ZXMucmVqZWN0ZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLmxvYWRpbmcgPSBmYWxzZTsgc3RhdGUuZXJyb3IgPSBhY3Rpb24uZXJyb3IubWVzc2FnZSB8fCAn7Iqk7JyE7Yq4IOu2iOufrOyYpOq4sCDsi6TtjKgnOyB9KVxuICAgICAgLy8g66a066as7KaIIOyDneyEsVxuICAgICAgLmFkZENhc2UoY3JlYXRlUmVsZWFzZS5mdWxmaWxsZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7IHN0YXRlLnJlbGVhc2VzLnB1c2goYWN0aW9uLnBheWxvYWQpOyB9KVxuICAgICAgLy8g66a066as7KaIIOyImOyglVxuICAgICAgLmFkZENhc2UodXBkYXRlUmVsZWFzZS5mdWxmaWxsZWQsIChzdGF0ZSwgYWN0aW9uKSA9PiB7XG4gICAgICAgIGNvbnN0IGlkeCA9IHN0YXRlLnJlbGVhc2VzLmZpbmRJbmRleChyID0+IHIuaWQgPT09IGFjdGlvbi5wYXlsb2FkLmlkKTtcbiAgICAgICAgaWYgKGlkeCAhPT0gLTEpIHN0YXRlLnJlbGVhc2VzW2lkeF0gPSBhY3Rpb24ucGF5bG9hZDtcbiAgICAgIH0pXG4gICAgICAvLyDrprTrpqzspogg7IKt7KCcXG4gICAgICAuYWRkQ2FzZShkZWxldGVSZWxlYXNlLmZ1bGZpbGxlZCwgKHN0YXRlLCBhY3Rpb24pID0+IHtcbiAgICAgICAgc3RhdGUucmVsZWFzZXMgPSBzdGF0ZS5yZWxlYXNlcy5maWx0ZXIociA9PiByLmlkICE9PSBhY3Rpb24ucGF5bG9hZCk7XG4gICAgICB9KTtcbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByZWxlYXNlU2xpY2UucmVkdWNlcjsgIl0sInZlcnNpb24iOjN9