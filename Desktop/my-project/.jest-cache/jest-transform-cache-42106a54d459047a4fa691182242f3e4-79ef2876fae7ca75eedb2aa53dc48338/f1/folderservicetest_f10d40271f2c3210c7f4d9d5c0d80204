251aaa48d2848c05f3244a348794ec4f
"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
// Mock folderRepository
globals_1.jest.mock('../src/main/app/domains/folders/repositories/folderRepository');
const folderService = __importStar(require("../src/main/app/domains/folders/services/folderService"));
const folderRepository = __importStar(require("../src/main/app/domains/folders/repositories/folderRepository"));
const mockFolderRepository = folderRepository;
(0, globals_1.describe)('Folder Service', () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
    });
    (0, globals_1.describe)('createFolder', () => {
        (0, globals_1.it)('should create a folder successfully', async () => {
            const folderData = {
                name: 'Test Folder',
                description: 'Test Description',
                parentId: undefined,
                sortOrder: 0,
                createdBy: 'testuser'
            };
            const expectedFolder = {
                id: 1,
                name: 'Test Folder',
                description: 'Test Description',
                parentId: undefined,
                sortOrder: 0,
                createdBy: 'testuser',
                createdAt: new Date(),
                updatedAt: new Date()
            };
            mockFolderRepository.createFolder.mockResolvedValue(expectedFolder);
            const result = await folderService.createFolder(folderData);
            (0, globals_1.expect)(result).toEqual(expectedFolder);
            (0, globals_1.expect)(mockFolderRepository.createFolder).toHaveBeenCalledWith(folderData);
        });
    });
    (0, globals_1.describe)('getFolderById', () => {
        (0, globals_1.it)('should return folder when found', async () => {
            const folderId = 1;
            const expectedFolder = {
                id: 1,
                name: 'Test Folder',
                description: 'Test Description',
                parentId: undefined,
                sortOrder: 0,
                createdBy: 'testuser',
                createdAt: new Date(),
                updatedAt: new Date()
            };
            mockFolderRepository.getFolderById.mockResolvedValue(expectedFolder);
            const result = await folderService.getFolderById(folderId);
            (0, globals_1.expect)(result).toEqual(expectedFolder);
            (0, globals_1.expect)(mockFolderRepository.getFolderById).toHaveBeenCalledWith(folderId);
        });
        (0, globals_1.it)('should return null when folder not found', async () => {
            const folderId = 999;
            mockFolderRepository.getFolderById.mockResolvedValue(null);
            const result = await folderService.getFolderById(folderId);
            (0, globals_1.expect)(result).toBeNull();
            (0, globals_1.expect)(mockFolderRepository.getFolderById).toHaveBeenCalledWith(folderId);
        });
    });
    (0, globals_1.describe)('listFolders', () => {
        (0, globals_1.it)('should return list of folders', async () => {
            const expectedFolders = [
                {
                    id: 1,
                    name: 'Folder 1',
                    description: 'Description 1',
                    parentId: undefined,
                    sortOrder: 0,
                    createdBy: 'testuser',
                    createdAt: new Date(),
                    updatedAt: new Date()
                },
                {
                    id: 2,
                    name: 'Folder 2',
                    description: 'Description 2',
                    parentId: 1,
                    sortOrder: 1,
                    createdBy: 'testuser',
                    createdAt: new Date(),
                    updatedAt: new Date()
                }
            ];
            mockFolderRepository.listFolders.mockResolvedValue(expectedFolders);
            const result = await folderService.listFolders();
            (0, globals_1.expect)(result).toEqual(expectedFolders);
            (0, globals_1.expect)(mockFolderRepository.listFolders).toHaveBeenCalled();
        });
    });
    (0, globals_1.describe)('updateFolder', () => {
        (0, globals_1.it)('should update folder successfully', async () => {
            const folderId = 1;
            const updateData = {
                name: 'Updated Folder',
                description: 'Updated Description',
                updatedBy: 'testuser'
            };
            const expectedFolder = {
                id: 1,
                name: 'Updated Folder',
                description: 'Updated Description',
                parentId: undefined,
                sortOrder: 0,
                createdBy: 'testuser',
                createdAt: new Date(),
                updatedAt: new Date()
            };
            mockFolderRepository.updateFolder.mockResolvedValue(expectedFolder);
            const result = await folderService.updateFolder(folderId, updateData);
            (0, globals_1.expect)(result).toEqual(expectedFolder);
            (0, globals_1.expect)(mockFolderRepository.updateFolder).toHaveBeenCalledWith(folderId, updateData);
        });
        (0, globals_1.it)('should return null when folder not found', async () => {
            const folderId = 999;
            const updateData = {
                name: 'Updated Folder',
                updatedBy: 'testuser'
            };
            mockFolderRepository.updateFolder.mockResolvedValue(null);
            const result = await folderService.updateFolder(folderId, updateData);
            (0, globals_1.expect)(result).toBeNull();
            (0, globals_1.expect)(mockFolderRepository.updateFolder).toHaveBeenCalledWith(folderId, updateData);
        });
    });
    (0, globals_1.describe)('deleteFolder', () => {
        (0, globals_1.it)('should delete folder successfully', async () => {
            const folderId = 1;
            mockFolderRepository.deleteFolder.mockResolvedValue(true);
            const result = await folderService.deleteFolder(folderId);
            (0, globals_1.expect)(result).toBe(true);
            (0, globals_1.expect)(mockFolderRepository.deleteFolder).toHaveBeenCalledWith(folderId);
        });
        (0, globals_1.it)('should return false when folder not found', async () => {
            const folderId = 999;
            mockFolderRepository.deleteFolder.mockResolvedValue(false);
            const result = await folderService.deleteFolder(folderId);
            (0, globals_1.expect)(result).toBe(false);
            (0, globals_1.expect)(mockFolderRepository.deleteFolder).toHaveBeenCalledWith(folderId);
        });
    });
    (0, globals_1.describe)('addTestCaseToFolder', () => {
        (0, globals_1.it)('should add test case to folder successfully', async () => {
            const testCaseId = 1;
            const folderId = 1;
            const mockFolder = {
                id: 1,
                name: 'Test Folder',
                description: 'Test Description',
                parentId: undefined,
                sortOrder: 0,
                createdBy: 'testuser',
                createdAt: new Date(),
                updatedAt: new Date()
            };
            mockFolderRepository.getFolderById.mockResolvedValue(mockFolder);
            mockFolderRepository.addTestCaseToFolder.mockResolvedValue(true);
            const result = await folderService.addTestCaseToFolder(testCaseId, folderId);
            (0, globals_1.expect)(result).toBe(true);
            (0, globals_1.expect)(mockFolderRepository.getFolderById).toHaveBeenCalledWith(folderId);
            (0, globals_1.expect)(mockFolderRepository.addTestCaseToFolder).toHaveBeenCalledWith(testCaseId, folderId);
        });
        (0, globals_1.it)('should throw error when folder not found', async () => {
            const testCaseId = 1;
            const folderId = 999;
            mockFolderRepository.getFolderById.mockResolvedValue(null);
            await (0, globals_1.expect)(folderService.addTestCaseToFolder(testCaseId, folderId))
                .rejects
                .toThrow('폴더를 찾을 수 없습니다.');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzLzNpLWExLTIwMjEtMDE3L0Rlc2t0b3AvbXktcHJvamVjdC90ZXN0cy9mb2xkZXIuc2VydmljZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsMkNBQXVFO0FBSXZFLHdCQUF3QjtBQUN4QixjQUFJLENBQUMsSUFBSSxDQUFDLCtEQUErRCxDQUFDLENBQUM7QUFKM0Usc0dBQXdGO0FBQ3hGLGdIQUFrRztBQUlsRyxNQUFNLG9CQUFvQixHQUFHLGdCQUF3RCxDQUFDO0FBRXRGLElBQUEsa0JBQVEsRUFBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUU7SUFDOUIsSUFBQSxvQkFBVSxFQUFDLEdBQUcsRUFBRTtRQUNkLGNBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN2QixDQUFDLENBQUMsQ0FBQztJQUVILElBQUEsa0JBQVEsRUFBQyxjQUFjLEVBQUUsR0FBRyxFQUFFO1FBQzVCLElBQUEsWUFBRSxFQUFDLHFDQUFxQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ25ELE1BQU0sVUFBVSxHQUFHO2dCQUNqQixJQUFJLEVBQUUsYUFBYTtnQkFDbkIsV0FBVyxFQUFFLGtCQUFrQjtnQkFDL0IsUUFBUSxFQUFFLFNBQVM7Z0JBQ25CLFNBQVMsRUFBRSxDQUFDO2dCQUNaLFNBQVMsRUFBRSxVQUFVO2FBQ3RCLENBQUM7WUFFRixNQUFNLGNBQWMsR0FBRztnQkFDckIsRUFBRSxFQUFFLENBQUM7Z0JBQ0wsSUFBSSxFQUFFLGFBQWE7Z0JBQ25CLFdBQVcsRUFBRSxrQkFBa0I7Z0JBQy9CLFFBQVEsRUFBRSxTQUFTO2dCQUNuQixTQUFTLEVBQUUsQ0FBQztnQkFDWixTQUFTLEVBQUUsVUFBVTtnQkFDckIsU0FBUyxFQUFFLElBQUksSUFBSSxFQUFFO2dCQUNyQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7YUFDdEIsQ0FBQztZQUVGLG9CQUFvQixDQUFDLFlBQVksQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsQ0FBQztZQUVw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QU0sTUFBTSxHQUFHLE1BQU0sYUFBYSxDQUFDLG1CQUFtQixDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUMsQ0FBQztZQUU3RSxJQUFBLGdCQUFNLEVBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzFCLElBQUEsZ0JBQU0sRUFBQyxvQkFBb0IsQ0FBQyxhQUFhLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUMxRSxJQUFBLGdCQUFNLEVBQUMsb0JBQW9CLENBQUMsbUJBQW1CLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDOUYsQ0FBQyxDQUFDLENBQUM7UUFFSCxJQUFBLFlBQUUsRUFBQywwQ0FBMEMsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN4RCxNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUM7WUFDckIsTUFBTSxRQUFRLEdBQUcsR0FBRyxDQUFDO1lBRXJCLG9CQUFvQixDQUFDLGFBQWEsQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUUzRCxNQUFNLElBQUEsZ0JBQU0sRUFBQyxhQUFhLENBQUMsbUJBQW1CLENBQUMsVUFBVSxFQUFFLFFBQVEsQ0FBQyxDQUFDO2lCQUNsRSxPQUFPO2lCQUNQLE9BQU8sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvM2ktYTEtMjAyMS0wMTcvRGVza3RvcC9teS1wcm9qZWN0L3Rlc3RzL2ZvbGRlci5zZXJ2aWNlLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVzY3JpYmUsIGl0LCBleHBlY3QsIGJlZm9yZUVhY2gsIGplc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCAqIGFzIGZvbGRlclNlcnZpY2UgZnJvbSAnLi4vc3JjL21haW4vYXBwL2RvbWFpbnMvZm9sZGVycy9zZXJ2aWNlcy9mb2xkZXJTZXJ2aWNlJztcbmltcG9ydCAqIGFzIGZvbGRlclJlcG9zaXRvcnkgZnJvbSAnLi4vc3JjL21haW4vYXBwL2RvbWFpbnMvZm9sZGVycy9yZXBvc2l0b3JpZXMvZm9sZGVyUmVwb3NpdG9yeSc7XG5cbi8vIE1vY2sgZm9sZGVyUmVwb3NpdG9yeVxuamVzdC5tb2NrKCcuLi9zcmMvbWFpbi9hcHAvZG9tYWlucy9mb2xkZXJzL3JlcG9zaXRvcmllcy9mb2xkZXJSZXBvc2l0b3J5Jyk7XG5jb25zdCBtb2NrRm9sZGVyUmVwb3NpdG9yeSA9IGZvbGRlclJlcG9zaXRvcnkgYXMgamVzdC5Nb2NrZWQ8dHlwZW9mIGZvbGRlclJlcG9zaXRvcnk+O1xuXG5kZXNjcmliZSgnRm9sZGVyIFNlcnZpY2UnLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZSgnY3JlYXRlRm9sZGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgY3JlYXRlIGEgZm9sZGVyIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZvbGRlckRhdGEgPSB7XG4gICAgICAgIG5hbWU6ICdUZXN0IEZvbGRlcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBEZXNjcmlwdGlvbicsXG4gICAgICAgIHBhcmVudElkOiB1bmRlZmluZWQsXG4gICAgICAgIHNvcnRPcmRlcjogMCxcbiAgICAgICAgY3JlYXRlZEJ5OiAndGVzdHVzZXInXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBleHBlY3RlZEZvbGRlciA9IHtcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIG5hbWU6ICdUZXN0IEZvbGRlcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBEZXNjcmlwdGlvbicsXG4gICAgICAgIHBhcmVudElkOiB1bmRlZmluZWQsXG4gICAgICAgIHNvcnRPcmRlcjogMCxcbiAgICAgICAgY3JlYXRlZEJ5OiAndGVzdHVzZXInLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkuY3JlYXRlRm9sZGVyLm1vY2tSZXNvbHZlZFZhbHVlKGV4cGVjdGVkRm9sZGVyKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm9sZGVyU2VydmljZS5jcmVhdGVGb2xkZXIoZm9sZGVyRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZXhwZWN0ZWRGb2xkZXIpO1xuICAgICAgZXhwZWN0KG1vY2tGb2xkZXJSZXBvc2l0b3J5LmNyZWF0ZUZvbGRlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZm9sZGVyRGF0YSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRGb2xkZXJCeUlkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGZvbGRlciB3aGVuIGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZm9sZGVySWQgPSAxO1xuICAgICAgY29uc3QgZXhwZWN0ZWRGb2xkZXIgPSB7XG4gICAgICAgIGlkOiAxLFxuICAgICAgICBuYW1lOiAnVGVzdCBGb2xkZXInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1Rlc3QgRGVzY3JpcHRpb24nLFxuICAgICAgICBwYXJlbnRJZDogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0T3JkZXI6IDAsXG4gICAgICAgIGNyZWF0ZWRCeTogJ3Rlc3R1c2VyJyxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICAgIH07XG5cbiAgICAgIG1vY2tGb2xkZXJSZXBvc2l0b3J5LmdldEZvbGRlckJ5SWQubW9ja1Jlc29sdmVkVmFsdWUoZXhwZWN0ZWRGb2xkZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLmdldEZvbGRlckJ5SWQoZm9sZGVySWQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0VxdWFsKGV4cGVjdGVkRm9sZGVyKTtcbiAgICAgIGV4cGVjdChtb2NrRm9sZGVyUmVwb3NpdG9yeS5nZXRGb2xkZXJCeUlkKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmb2xkZXJJZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBudWxsIHdoZW4gZm9sZGVyIG5vdCBmb3VuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZvbGRlcklkID0gOTk5O1xuXG4gICAgICBtb2NrRm9sZGVyUmVwb3NpdG9yeS5nZXRGb2xkZXJCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLmdldEZvbGRlckJ5SWQoZm9sZGVySWQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlTnVsbCgpO1xuICAgICAgZXhwZWN0KG1vY2tGb2xkZXJSZXBvc2l0b3J5LmdldEZvbGRlckJ5SWQpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZvbGRlcklkKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2xpc3RGb2xkZXJzJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIGxpc3Qgb2YgZm9sZGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGV4cGVjdGVkRm9sZGVycyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgIG5hbWU6ICdGb2xkZXIgMScsXG4gICAgICAgICAgZGVzY3JpcHRpb246ICdEZXNjcmlwdGlvbiAxJyxcbiAgICAgICAgICBwYXJlbnRJZDogdW5kZWZpbmVkLFxuICAgICAgICAgIHNvcnRPcmRlcjogMCxcbiAgICAgICAgICBjcmVhdGVkQnk6ICd0ZXN0dXNlcicsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgaWQ6IDIsXG4gICAgICAgICAgbmFtZTogJ0ZvbGRlciAyJyxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogJ0Rlc2NyaXB0aW9uIDInLFxuICAgICAgICAgIHBhcmVudElkOiAxLFxuICAgICAgICAgIHNvcnRPcmRlcjogMSxcbiAgICAgICAgICBjcmVhdGVkQnk6ICd0ZXN0dXNlcicsXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgICB9XG4gICAgICBdO1xuXG4gICAgICBtb2NrRm9sZGVyUmVwb3NpdG9yeS5saXN0Rm9sZGVycy5tb2NrUmVzb2x2ZWRWYWx1ZShleHBlY3RlZEZvbGRlcnMpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLmxpc3RGb2xkZXJzKCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZXhwZWN0ZWRGb2xkZXJzKTtcbiAgICAgIGV4cGVjdChtb2NrRm9sZGVyUmVwb3NpdG9yeS5saXN0Rm9sZGVycykudG9IYXZlQmVlbkNhbGxlZCgpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndXBkYXRlRm9sZGVyJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdXBkYXRlIGZvbGRlciBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmb2xkZXJJZCA9IDE7XG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0ge1xuICAgICAgICBuYW1lOiAnVXBkYXRlZCBGb2xkZXInLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1VwZGF0ZWQgRGVzY3JpcHRpb24nLFxuICAgICAgICB1cGRhdGVkQnk6ICd0ZXN0dXNlcidcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGV4cGVjdGVkRm9sZGVyID0ge1xuICAgICAgICBpZDogMSxcbiAgICAgICAgbmFtZTogJ1VwZGF0ZWQgRm9sZGVyJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICdVcGRhdGVkIERlc2NyaXB0aW9uJyxcbiAgICAgICAgcGFyZW50SWQ6IHVuZGVmaW5lZCxcbiAgICAgICAgc29ydE9yZGVyOiAwLFxuICAgICAgICBjcmVhdGVkQnk6ICd0ZXN0dXNlcicsXG4gICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgICB9O1xuXG4gICAgICBtb2NrRm9sZGVyUmVwb3NpdG9yeS51cGRhdGVGb2xkZXIubW9ja1Jlc29sdmVkVmFsdWUoZXhwZWN0ZWRGb2xkZXIpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLnVwZGF0ZUZvbGRlcihmb2xkZXJJZCwgdXBkYXRlRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoZXhwZWN0ZWRGb2xkZXIpO1xuICAgICAgZXhwZWN0KG1vY2tGb2xkZXJSZXBvc2l0b3J5LnVwZGF0ZUZvbGRlcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoZm9sZGVySWQsIHVwZGF0ZURhdGEpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gbnVsbCB3aGVuIGZvbGRlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmb2xkZXJJZCA9IDk5OTtcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7XG4gICAgICAgIG5hbWU6ICdVcGRhdGVkIEZvbGRlcicsXG4gICAgICAgIHVwZGF0ZWRCeTogJ3Rlc3R1c2VyJ1xuICAgICAgfTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkudXBkYXRlRm9sZGVyLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLnVwZGF0ZUZvbGRlcihmb2xkZXJJZCwgdXBkYXRlRGF0YSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVOdWxsKCk7XG4gICAgICBleHBlY3QobW9ja0ZvbGRlclJlcG9zaXRvcnkudXBkYXRlRm9sZGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmb2xkZXJJZCwgdXBkYXRlRGF0YSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdkZWxldGVGb2xkZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBkZWxldGUgZm9sZGVyIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGZvbGRlcklkID0gMTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkuZGVsZXRlRm9sZGVyLm1vY2tSZXNvbHZlZFZhbHVlKHRydWUpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBmb2xkZXJTZXJ2aWNlLmRlbGV0ZUZvbGRlcihmb2xkZXJJZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja0ZvbGRlclJlcG9zaXRvcnkuZGVsZXRlRm9sZGVyKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChmb2xkZXJJZCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJldHVybiBmYWxzZSB3aGVuIGZvbGRlciBub3QgZm91bmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBmb2xkZXJJZCA9IDk5OTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkuZGVsZXRlRm9sZGVyLm1vY2tSZXNvbHZlZFZhbHVlKGZhbHNlKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZm9sZGVyU2VydmljZS5kZWxldGVGb2xkZXIoZm9sZGVySWQpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChtb2NrRm9sZGVyUmVwb3NpdG9yeS5kZWxldGVGb2xkZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGZvbGRlcklkKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2FkZFRlc3RDYXNlVG9Gb2xkZXInLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBhZGQgdGVzdCBjYXNlIHRvIGZvbGRlciBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0ZXN0Q2FzZUlkID0gMTtcbiAgICAgIGNvbnN0IGZvbGRlcklkID0gMTtcblxuICAgICAgY29uc3QgbW9ja0ZvbGRlciA9IHtcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIG5hbWU6ICdUZXN0IEZvbGRlcicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnVGVzdCBEZXNjcmlwdGlvbicsXG4gICAgICAgIHBhcmVudElkOiB1bmRlZmluZWQsXG4gICAgICAgIHNvcnRPcmRlcjogMCxcbiAgICAgICAgY3JlYXRlZEJ5OiAndGVzdHVzZXInLFxuICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgICAgfTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkuZ2V0Rm9sZGVyQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrRm9sZGVyKTtcbiAgICAgIG1vY2tGb2xkZXJSZXBvc2l0b3J5LmFkZFRlc3RDYXNlVG9Gb2xkZXIubW9ja1Jlc29sdmVkVmFsdWUodHJ1ZSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGZvbGRlclNlcnZpY2UuYWRkVGVzdENhc2VUb0ZvbGRlcih0ZXN0Q2FzZUlkLCBmb2xkZXJJZCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobW9ja0ZvbGRlclJlcG9zaXRvcnkuZ2V0Rm9sZGVyQnlJZCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoZm9sZGVySWQpO1xuICAgICAgZXhwZWN0KG1vY2tGb2xkZXJSZXBvc2l0b3J5LmFkZFRlc3RDYXNlVG9Gb2xkZXIpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKHRlc3RDYXNlSWQsIGZvbGRlcklkKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiBmb2xkZXIgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdGVzdENhc2VJZCA9IDE7XG4gICAgICBjb25zdCBmb2xkZXJJZCA9IDk5OTtcblxuICAgICAgbW9ja0ZvbGRlclJlcG9zaXRvcnkuZ2V0Rm9sZGVyQnlJZC5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgYXdhaXQgZXhwZWN0KGZvbGRlclNlcnZpY2UuYWRkVGVzdENhc2VUb0ZvbGRlcih0ZXN0Q2FzZUlkLCBmb2xkZXJJZCkpXG4gICAgICAgIC5yZWplY3RzXG4gICAgICAgIC50b1Rocm93KCftj7TrjZTrpbwg7LC+7J2EIOyImCDsl4bsirXri4jri6QuJyk7XG4gICAgfSk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==