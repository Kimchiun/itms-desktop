ee54e7273ddaa348e6fff3b42ab54595
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.conductCheck = conductCheck;
exports.isCheckDisabled = isCheckDisabled;
var _warning = _interopRequireDefault(require("rc-util/lib/warning"));
var _keyUtil = _interopRequireDefault(require("./keyUtil"));
function removeFromCheckedKeys(halfCheckedKeys, checkedKeys) {
  var filteredKeys = new Set();
  halfCheckedKeys.forEach(function (key) {
    if (!checkedKeys.has(key)) {
      filteredKeys.add(key);
    }
  });
  return filteredKeys;
}
function isCheckDisabled(node) {
  var _ref = node || {},
    disabled = _ref.disabled,
    disableCheckbox = _ref.disableCheckbox,
    checkable = _ref.checkable;
  return !!(disabled || disableCheckbox) || checkable === false;
}

// Fill miss keys
function fillConductCheck(keys, levelEntities, maxLevel, syntheticGetCheckDisabled) {
  var checkedKeys = new Set(keys);
  var halfCheckedKeys = new Set();

  // Add checked keys top to bottom
  for (var level = 0; level <= maxLevel; level += 1) {
    var entities = levelEntities.get(level) || new Set();
    entities.forEach(function (entity) {
      var key = entity.key,
        node = entity.node,
        _entity$children = entity.children,
        children = _entity$children === void 0 ? [] : _entity$children;
      if (checkedKeys.has(key) && !syntheticGetCheckDisabled(node)) {
        children.filter(function (childEntity) {
          return !syntheticGetCheckDisabled(childEntity.node);
        }).forEach(function (childEntity) {
          checkedKeys.add(childEntity.key);
        });
      }
    });
  }

  // Add checked keys from bottom to top
  var visitedKeys = new Set();
  for (var _level = maxLevel; _level >= 0; _level -= 1) {
    var _entities = levelEntities.get(_level) || new Set();
    _entities.forEach(function (entity) {
      var parent = entity.parent,
        node = entity.node;

      // Skip if no need to check
      if (syntheticGetCheckDisabled(node) || !entity.parent || visitedKeys.has(entity.parent.key)) {
        return;
      }

      // Skip if parent is disabled
      if (syntheticGetCheckDisabled(entity.parent.node)) {
        visitedKeys.add(parent.key);
        return;
      }
      var allChecked = true;
      var partialChecked = false;
      (parent.children || []).filter(function (childEntity) {
        return !syntheticGetCheckDisabled(childEntity.node);
      }).forEach(function (_ref2) {
        var key = _ref2.key;
        var checked = checkedKeys.has(key);
        if (allChecked && !checked) {
          allChecked = false;
        }
        if (!partialChecked && (checked || halfCheckedKeys.has(key))) {
          partialChecked = true;
        }
      });
      if (allChecked) {
        checkedKeys.add(parent.key);
      }
      if (partialChecked) {
        halfCheckedKeys.add(parent.key);
      }
      visitedKeys.add(parent.key);
    });
  }
  return {
    checkedKeys: Array.from(checkedKeys),
    halfCheckedKeys: Array.from(removeFromCheckedKeys(halfCheckedKeys, checkedKeys))
  };
}

// Remove useless key
function cleanConductCheck(keys, halfKeys, levelEntities, maxLevel, syntheticGetCheckDisabled) {
  var checkedKeys = new Set(keys);
  var halfCheckedKeys = new Set(halfKeys);

  // Remove checked keys from top to bottom
  for (var level = 0; level <= maxLevel; level += 1) {
    var entities = levelEntities.get(level) || new Set();
    entities.forEach(function (entity) {
      var key = entity.key,
        node = entity.node,
        _entity$children2 = entity.children,
        children = _entity$children2 === void 0 ? [] : _entity$children2;
      if (!checkedKeys.has(key) && !halfCheckedKeys.has(key) && !syntheticGetCheckDisabled(node)) {
        children.filter(function (childEntity) {
          return !syntheticGetCheckDisabled(childEntity.node);
        }).forEach(function (childEntity) {
          checkedKeys.delete(childEntity.key);
        });
      }
    });
  }

  // Remove checked keys form bottom to top
  halfCheckedKeys = new Set();
  var visitedKeys = new Set();
  for (var _level2 = maxLevel; _level2 >= 0; _level2 -= 1) {
    var _entities2 = levelEntities.get(_level2) || new Set();
    _entities2.forEach(function (entity) {
      var parent = entity.parent,
        node = entity.node;

      // Skip if no need to check
      if (syntheticGetCheckDisabled(node) || !entity.parent || visitedKeys.has(entity.parent.key)) {
        return;
      }

      // Skip if parent is disabled
      if (syntheticGetCheckDisabled(entity.parent.node)) {
        visitedKeys.add(parent.key);
        return;
      }
      var allChecked = true;
      var partialChecked = false;
      (parent.children || []).filter(function (childEntity) {
        return !syntheticGetCheckDisabled(childEntity.node);
      }).forEach(function (_ref3) {
        var key = _ref3.key;
        var checked = checkedKeys.has(key);
        if (allChecked && !checked) {
          allChecked = false;
        }
        if (!partialChecked && (checked || halfCheckedKeys.has(key))) {
          partialChecked = true;
        }
      });
      if (!allChecked) {
        checkedKeys.delete(parent.key);
      }
      if (partialChecked) {
        halfCheckedKeys.add(parent.key);
      }
      visitedKeys.add(parent.key);
    });
  }
  return {
    checkedKeys: Array.from(checkedKeys),
    halfCheckedKeys: Array.from(removeFromCheckedKeys(halfCheckedKeys, checkedKeys))
  };
}

/**
 * Conduct with keys.
 * @param keyList current key list
 * @param keyEntities key - dataEntity map
 * @param mode `fill` to fill missing key, `clean` to remove useless key
 */
function conductCheck(keyList, checked, keyEntities, getCheckDisabled) {
  var warningMissKeys = [];
  var syntheticGetCheckDisabled;
  if (getCheckDisabled) {
    syntheticGetCheckDisabled = getCheckDisabled;
  } else {
    syntheticGetCheckDisabled = isCheckDisabled;
  }

  // We only handle exist keys
  var keys = new Set(keyList.filter(function (key) {
    var hasEntity = !!(0, _keyUtil.default)(keyEntities, key);
    if (!hasEntity) {
      warningMissKeys.push(key);
    }
    return hasEntity;
  }));
  var levelEntities = new Map();
  var maxLevel = 0;

  // Convert entities by level for calculation
  Object.keys(keyEntities).forEach(function (key) {
    var entity = keyEntities[key];
    var level = entity.level;
    var levelSet = levelEntities.get(level);
    if (!levelSet) {
      levelSet = new Set();
      levelEntities.set(level, levelSet);
    }
    levelSet.add(entity);
    maxLevel = Math.max(maxLevel, level);
  });
  (0, _warning.default)(!warningMissKeys.length, "Tree missing follow keys: ".concat(warningMissKeys.slice(0, 100).map(function (key) {
    return "'".concat(key, "'");
  }).join(', ')));
  var result;
  if (checked === true) {
    result = fillConductCheck(keys, levelEntities, maxLevel, syntheticGetCheckDisabled);
  } else {
    result = cleanConductCheck(keys, checked.halfCheckedKeys, levelEntities, maxLevel, syntheticGetCheckDisabled);
  }
  return result;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiY29uZHVjdENoZWNrIiwiaXNDaGVja0Rpc2FibGVkIiwiX3dhcm5pbmciLCJfa2V5VXRpbCIsInJlbW92ZUZyb21DaGVja2VkS2V5cyIsImhhbGZDaGVja2VkS2V5cyIsImNoZWNrZWRLZXlzIiwiZmlsdGVyZWRLZXlzIiwiU2V0IiwiZm9yRWFjaCIsImtleSIsImhhcyIsImFkZCIsIm5vZGUiLCJfcmVmIiwiZGlzYWJsZWQiLCJkaXNhYmxlQ2hlY2tib3giLCJjaGVja2FibGUiLCJmaWxsQ29uZHVjdENoZWNrIiwia2V5cyIsImxldmVsRW50aXRpZXMiLCJtYXhMZXZlbCIsInN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQiLCJsZXZlbCIsImVudGl0aWVzIiwiZ2V0IiwiZW50aXR5IiwiX2VudGl0eSRjaGlsZHJlbiIsImNoaWxkcmVuIiwiZmlsdGVyIiwiY2hpbGRFbnRpdHkiLCJ2aXNpdGVkS2V5cyIsIl9sZXZlbCIsIl9lbnRpdGllcyIsInBhcmVudCIsImFsbENoZWNrZWQiLCJwYXJ0aWFsQ2hlY2tlZCIsIl9yZWYyIiwiY2hlY2tlZCIsIkFycmF5IiwiZnJvbSIsImNsZWFuQ29uZHVjdENoZWNrIiwiaGFsZktleXMiLCJfZW50aXR5JGNoaWxkcmVuMiIsImRlbGV0ZSIsIl9sZXZlbDIiLCJfZW50aXRpZXMyIiwiX3JlZjMiLCJrZXlMaXN0Iiwia2V5RW50aXRpZXMiLCJnZXRDaGVja0Rpc2FibGVkIiwid2FybmluZ01pc3NLZXlzIiwiaGFzRW50aXR5IiwiZGVmYXVsdCIsInB1c2giLCJNYXAiLCJsZXZlbFNldCIsInNldCIsIk1hdGgiLCJtYXgiLCJsZW5ndGgiLCJjb25jYXQiLCJzbGljZSIsIm1hcCIsImpvaW4iLCJyZXN1bHQiXSwic291cmNlcyI6WyJjb25kdWN0VXRpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxudmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jb25kdWN0Q2hlY2sgPSBjb25kdWN0Q2hlY2s7XG5leHBvcnRzLmlzQ2hlY2tEaXNhYmxlZCA9IGlzQ2hlY2tEaXNhYmxlZDtcbnZhciBfd2FybmluZyA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcInJjLXV0aWwvbGliL3dhcm5pbmdcIikpO1xudmFyIF9rZXlVdGlsID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9rZXlVdGlsXCIpKTtcbmZ1bmN0aW9uIHJlbW92ZUZyb21DaGVja2VkS2V5cyhoYWxmQ2hlY2tlZEtleXMsIGNoZWNrZWRLZXlzKSB7XG4gIHZhciBmaWx0ZXJlZEtleXMgPSBuZXcgU2V0KCk7XG4gIGhhbGZDaGVja2VkS2V5cy5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICBpZiAoIWNoZWNrZWRLZXlzLmhhcyhrZXkpKSB7XG4gICAgICBmaWx0ZXJlZEtleXMuYWRkKGtleSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGZpbHRlcmVkS2V5cztcbn1cbmZ1bmN0aW9uIGlzQ2hlY2tEaXNhYmxlZChub2RlKSB7XG4gIHZhciBfcmVmID0gbm9kZSB8fCB7fSxcbiAgICBkaXNhYmxlZCA9IF9yZWYuZGlzYWJsZWQsXG4gICAgZGlzYWJsZUNoZWNrYm94ID0gX3JlZi5kaXNhYmxlQ2hlY2tib3gsXG4gICAgY2hlY2thYmxlID0gX3JlZi5jaGVja2FibGU7XG4gIHJldHVybiAhIShkaXNhYmxlZCB8fCBkaXNhYmxlQ2hlY2tib3gpIHx8IGNoZWNrYWJsZSA9PT0gZmFsc2U7XG59XG5cbi8vIEZpbGwgbWlzcyBrZXlzXG5mdW5jdGlvbiBmaWxsQ29uZHVjdENoZWNrKGtleXMsIGxldmVsRW50aXRpZXMsIG1heExldmVsLCBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKSB7XG4gIHZhciBjaGVja2VkS2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gIHZhciBoYWxmQ2hlY2tlZEtleXMgPSBuZXcgU2V0KCk7XG5cbiAgLy8gQWRkIGNoZWNrZWQga2V5cyB0b3AgdG8gYm90dG9tXG4gIGZvciAodmFyIGxldmVsID0gMDsgbGV2ZWwgPD0gbWF4TGV2ZWw7IGxldmVsICs9IDEpIHtcbiAgICB2YXIgZW50aXRpZXMgPSBsZXZlbEVudGl0aWVzLmdldChsZXZlbCkgfHwgbmV3IFNldCgpO1xuICAgIGVudGl0aWVzLmZvckVhY2goZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgdmFyIGtleSA9IGVudGl0eS5rZXksXG4gICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZSxcbiAgICAgICAgX2VudGl0eSRjaGlsZHJlbiA9IGVudGl0eS5jaGlsZHJlbixcbiAgICAgICAgY2hpbGRyZW4gPSBfZW50aXR5JGNoaWxkcmVuID09PSB2b2lkIDAgPyBbXSA6IF9lbnRpdHkkY2hpbGRyZW47XG4gICAgICBpZiAoY2hlY2tlZEtleXMuaGFzKGtleSkgJiYgIXN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQobm9kZSkpIHtcbiAgICAgICAgY2hpbGRyZW4uZmlsdGVyKGZ1bmN0aW9uIChjaGlsZEVudGl0eSkge1xuICAgICAgICAgIHJldHVybiAhc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChjaGlsZEVudGl0eS5ub2RlKTtcbiAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgICBjaGVja2VkS2V5cy5hZGQoY2hpbGRFbnRpdHkua2V5KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvLyBBZGQgY2hlY2tlZCBrZXlzIGZyb20gYm90dG9tIHRvIHRvcFxuICB2YXIgdmlzaXRlZEtleXMgPSBuZXcgU2V0KCk7XG4gIGZvciAodmFyIF9sZXZlbCA9IG1heExldmVsOyBfbGV2ZWwgPj0gMDsgX2xldmVsIC09IDEpIHtcbiAgICB2YXIgX2VudGl0aWVzID0gbGV2ZWxFbnRpdGllcy5nZXQoX2xldmVsKSB8fCBuZXcgU2V0KCk7XG4gICAgX2VudGl0aWVzLmZvckVhY2goZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnQsXG4gICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZTtcblxuICAgICAgLy8gU2tpcCBpZiBubyBuZWVkIHRvIGNoZWNrXG4gICAgICBpZiAoc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChub2RlKSB8fCAhZW50aXR5LnBhcmVudCB8fCB2aXNpdGVkS2V5cy5oYXMoZW50aXR5LnBhcmVudC5rZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2tpcCBpZiBwYXJlbnQgaXMgZGlzYWJsZWRcbiAgICAgIGlmIChzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGVudGl0eS5wYXJlbnQubm9kZSkpIHtcbiAgICAgICAgdmlzaXRlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgYWxsQ2hlY2tlZCA9IHRydWU7XG4gICAgICB2YXIgcGFydGlhbENoZWNrZWQgPSBmYWxzZTtcbiAgICAgIChwYXJlbnQuY2hpbGRyZW4gfHwgW10pLmZpbHRlcihmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuICFzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGNoaWxkRW50aXR5Lm5vZGUpO1xuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjIpIHtcbiAgICAgICAgdmFyIGtleSA9IF9yZWYyLmtleTtcbiAgICAgICAgdmFyIGNoZWNrZWQgPSBjaGVja2VkS2V5cy5oYXMoa2V5KTtcbiAgICAgICAgaWYgKGFsbENoZWNrZWQgJiYgIWNoZWNrZWQpIHtcbiAgICAgICAgICBhbGxDaGVja2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJ0aWFsQ2hlY2tlZCAmJiAoY2hlY2tlZCB8fCBoYWxmQ2hlY2tlZEtleXMuaGFzKGtleSkpKSB7XG4gICAgICAgICAgcGFydGlhbENoZWNrZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChhbGxDaGVja2VkKSB7XG4gICAgICAgIGNoZWNrZWRLZXlzLmFkZChwYXJlbnQua2V5KTtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJ0aWFsQ2hlY2tlZCkge1xuICAgICAgICBoYWxmQ2hlY2tlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgfVxuICAgICAgdmlzaXRlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiB7XG4gICAgY2hlY2tlZEtleXM6IEFycmF5LmZyb20oY2hlY2tlZEtleXMpLFxuICAgIGhhbGZDaGVja2VkS2V5czogQXJyYXkuZnJvbShyZW1vdmVGcm9tQ2hlY2tlZEtleXMoaGFsZkNoZWNrZWRLZXlzLCBjaGVja2VkS2V5cykpXG4gIH07XG59XG5cbi8vIFJlbW92ZSB1c2VsZXNzIGtleVxuZnVuY3Rpb24gY2xlYW5Db25kdWN0Q2hlY2soa2V5cywgaGFsZktleXMsIGxldmVsRW50aXRpZXMsIG1heExldmVsLCBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKSB7XG4gIHZhciBjaGVja2VkS2V5cyA9IG5ldyBTZXQoa2V5cyk7XG4gIHZhciBoYWxmQ2hlY2tlZEtleXMgPSBuZXcgU2V0KGhhbGZLZXlzKTtcblxuICAvLyBSZW1vdmUgY2hlY2tlZCBrZXlzIGZyb20gdG9wIHRvIGJvdHRvbVxuICBmb3IgKHZhciBsZXZlbCA9IDA7IGxldmVsIDw9IG1heExldmVsOyBsZXZlbCArPSAxKSB7XG4gICAgdmFyIGVudGl0aWVzID0gbGV2ZWxFbnRpdGllcy5nZXQobGV2ZWwpIHx8IG5ldyBTZXQoKTtcbiAgICBlbnRpdGllcy5mb3JFYWNoKGZ1bmN0aW9uIChlbnRpdHkpIHtcbiAgICAgIHZhciBrZXkgPSBlbnRpdHkua2V5LFxuICAgICAgICBub2RlID0gZW50aXR5Lm5vZGUsXG4gICAgICAgIF9lbnRpdHkkY2hpbGRyZW4yID0gZW50aXR5LmNoaWxkcmVuLFxuICAgICAgICBjaGlsZHJlbiA9IF9lbnRpdHkkY2hpbGRyZW4yID09PSB2b2lkIDAgPyBbXSA6IF9lbnRpdHkkY2hpbGRyZW4yO1xuICAgICAgaWYgKCFjaGVja2VkS2V5cy5oYXMoa2V5KSAmJiAhaGFsZkNoZWNrZWRLZXlzLmhhcyhrZXkpICYmICFzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKG5vZGUpKSB7XG4gICAgICAgIGNoaWxkcmVuLmZpbHRlcihmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgICByZXR1cm4gIXN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQoY2hpbGRFbnRpdHkubm9kZSk7XG4gICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGNoaWxkRW50aXR5KSB7XG4gICAgICAgICAgY2hlY2tlZEtleXMuZGVsZXRlKGNoaWxkRW50aXR5LmtleSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gUmVtb3ZlIGNoZWNrZWQga2V5cyBmb3JtIGJvdHRvbSB0byB0b3BcbiAgaGFsZkNoZWNrZWRLZXlzID0gbmV3IFNldCgpO1xuICB2YXIgdmlzaXRlZEtleXMgPSBuZXcgU2V0KCk7XG4gIGZvciAodmFyIF9sZXZlbDIgPSBtYXhMZXZlbDsgX2xldmVsMiA+PSAwOyBfbGV2ZWwyIC09IDEpIHtcbiAgICB2YXIgX2VudGl0aWVzMiA9IGxldmVsRW50aXRpZXMuZ2V0KF9sZXZlbDIpIHx8IG5ldyBTZXQoKTtcbiAgICBfZW50aXRpZXMyLmZvckVhY2goZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgdmFyIHBhcmVudCA9IGVudGl0eS5wYXJlbnQsXG4gICAgICAgIG5vZGUgPSBlbnRpdHkubm9kZTtcblxuICAgICAgLy8gU2tpcCBpZiBubyBuZWVkIHRvIGNoZWNrXG4gICAgICBpZiAoc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZChub2RlKSB8fCAhZW50aXR5LnBhcmVudCB8fCB2aXNpdGVkS2V5cy5oYXMoZW50aXR5LnBhcmVudC5rZXkpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gU2tpcCBpZiBwYXJlbnQgaXMgZGlzYWJsZWRcbiAgICAgIGlmIChzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGVudGl0eS5wYXJlbnQubm9kZSkpIHtcbiAgICAgICAgdmlzaXRlZEtleXMuYWRkKHBhcmVudC5rZXkpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgYWxsQ2hlY2tlZCA9IHRydWU7XG4gICAgICB2YXIgcGFydGlhbENoZWNrZWQgPSBmYWxzZTtcbiAgICAgIChwYXJlbnQuY2hpbGRyZW4gfHwgW10pLmZpbHRlcihmdW5jdGlvbiAoY2hpbGRFbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuICFzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKGNoaWxkRW50aXR5Lm5vZGUpO1xuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAoX3JlZjMpIHtcbiAgICAgICAgdmFyIGtleSA9IF9yZWYzLmtleTtcbiAgICAgICAgdmFyIGNoZWNrZWQgPSBjaGVja2VkS2V5cy5oYXMoa2V5KTtcbiAgICAgICAgaWYgKGFsbENoZWNrZWQgJiYgIWNoZWNrZWQpIHtcbiAgICAgICAgICBhbGxDaGVja2VkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJ0aWFsQ2hlY2tlZCAmJiAoY2hlY2tlZCB8fCBoYWxmQ2hlY2tlZEtleXMuaGFzKGtleSkpKSB7XG4gICAgICAgICAgcGFydGlhbENoZWNrZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghYWxsQ2hlY2tlZCkge1xuICAgICAgICBjaGVja2VkS2V5cy5kZWxldGUocGFyZW50LmtleSk7XG4gICAgICB9XG4gICAgICBpZiAocGFydGlhbENoZWNrZWQpIHtcbiAgICAgICAgaGFsZkNoZWNrZWRLZXlzLmFkZChwYXJlbnQua2V5KTtcbiAgICAgIH1cbiAgICAgIHZpc2l0ZWRLZXlzLmFkZChwYXJlbnQua2V5KTtcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNoZWNrZWRLZXlzOiBBcnJheS5mcm9tKGNoZWNrZWRLZXlzKSxcbiAgICBoYWxmQ2hlY2tlZEtleXM6IEFycmF5LmZyb20ocmVtb3ZlRnJvbUNoZWNrZWRLZXlzKGhhbGZDaGVja2VkS2V5cywgY2hlY2tlZEtleXMpKVxuICB9O1xufVxuXG4vKipcbiAqIENvbmR1Y3Qgd2l0aCBrZXlzLlxuICogQHBhcmFtIGtleUxpc3QgY3VycmVudCBrZXkgbGlzdFxuICogQHBhcmFtIGtleUVudGl0aWVzIGtleSAtIGRhdGFFbnRpdHkgbWFwXG4gKiBAcGFyYW0gbW9kZSBgZmlsbGAgdG8gZmlsbCBtaXNzaW5nIGtleSwgYGNsZWFuYCB0byByZW1vdmUgdXNlbGVzcyBrZXlcbiAqL1xuZnVuY3Rpb24gY29uZHVjdENoZWNrKGtleUxpc3QsIGNoZWNrZWQsIGtleUVudGl0aWVzLCBnZXRDaGVja0Rpc2FibGVkKSB7XG4gIHZhciB3YXJuaW5nTWlzc0tleXMgPSBbXTtcbiAgdmFyIHN5bnRoZXRpY0dldENoZWNrRGlzYWJsZWQ7XG4gIGlmIChnZXRDaGVja0Rpc2FibGVkKSB7XG4gICAgc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZCA9IGdldENoZWNrRGlzYWJsZWQ7XG4gIH0gZWxzZSB7XG4gICAgc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZCA9IGlzQ2hlY2tEaXNhYmxlZDtcbiAgfVxuXG4gIC8vIFdlIG9ubHkgaGFuZGxlIGV4aXN0IGtleXNcbiAgdmFyIGtleXMgPSBuZXcgU2V0KGtleUxpc3QuZmlsdGVyKGZ1bmN0aW9uIChrZXkpIHtcbiAgICB2YXIgaGFzRW50aXR5ID0gISEoMCwgX2tleVV0aWwuZGVmYXVsdCkoa2V5RW50aXRpZXMsIGtleSk7XG4gICAgaWYgKCFoYXNFbnRpdHkpIHtcbiAgICAgIHdhcm5pbmdNaXNzS2V5cy5wdXNoKGtleSk7XG4gICAgfVxuICAgIHJldHVybiBoYXNFbnRpdHk7XG4gIH0pKTtcbiAgdmFyIGxldmVsRW50aXRpZXMgPSBuZXcgTWFwKCk7XG4gIHZhciBtYXhMZXZlbCA9IDA7XG5cbiAgLy8gQ29udmVydCBlbnRpdGllcyBieSBsZXZlbCBmb3IgY2FsY3VsYXRpb25cbiAgT2JqZWN0LmtleXMoa2V5RW50aXRpZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHZhciBlbnRpdHkgPSBrZXlFbnRpdGllc1trZXldO1xuICAgIHZhciBsZXZlbCA9IGVudGl0eS5sZXZlbDtcbiAgICB2YXIgbGV2ZWxTZXQgPSBsZXZlbEVudGl0aWVzLmdldChsZXZlbCk7XG4gICAgaWYgKCFsZXZlbFNldCkge1xuICAgICAgbGV2ZWxTZXQgPSBuZXcgU2V0KCk7XG4gICAgICBsZXZlbEVudGl0aWVzLnNldChsZXZlbCwgbGV2ZWxTZXQpO1xuICAgIH1cbiAgICBsZXZlbFNldC5hZGQoZW50aXR5KTtcbiAgICBtYXhMZXZlbCA9IE1hdGgubWF4KG1heExldmVsLCBsZXZlbCk7XG4gIH0pO1xuICAoMCwgX3dhcm5pbmcuZGVmYXVsdCkoIXdhcm5pbmdNaXNzS2V5cy5sZW5ndGgsIFwiVHJlZSBtaXNzaW5nIGZvbGxvdyBrZXlzOiBcIi5jb25jYXQod2FybmluZ01pc3NLZXlzLnNsaWNlKDAsIDEwMCkubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICByZXR1cm4gXCInXCIuY29uY2F0KGtleSwgXCInXCIpO1xuICB9KS5qb2luKCcsICcpKSk7XG4gIHZhciByZXN1bHQ7XG4gIGlmIChjaGVja2VkID09PSB0cnVlKSB7XG4gICAgcmVzdWx0ID0gZmlsbENvbmR1Y3RDaGVjayhrZXlzLCBsZXZlbEVudGl0aWVzLCBtYXhMZXZlbCwgc3ludGhldGljR2V0Q2hlY2tEaXNhYmxlZCk7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gY2xlYW5Db25kdWN0Q2hlY2soa2V5cywgY2hlY2tlZC5oYWxmQ2hlY2tlZEtleXMsIGxldmVsRW50aXRpZXMsIG1heExldmVsLCBzeW50aGV0aWNHZXRDaGVja0Rpc2FibGVkKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWixJQUFJQSxzQkFBc0IsR0FBR0MsT0FBTyxDQUFDLDhDQUE4QyxDQUFDO0FBQ3BGQyxNQUFNLENBQUNDLGNBQWMsQ0FBQ0MsT0FBTyxFQUFFLFlBQVksRUFBRTtFQUMzQ0MsS0FBSyxFQUFFO0FBQ1QsQ0FBQyxDQUFDO0FBQ0ZELE9BQU8sQ0FBQ0UsWUFBWSxHQUFHQSxZQUFZO0FBQ25DRixPQUFPLENBQUNHLGVBQWUsR0FBR0EsZUFBZTtBQUN6QyxJQUFJQyxRQUFRLEdBQUdSLHNCQUFzQixDQUFDQyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQztBQUNyRSxJQUFJUSxRQUFRLEdBQUdULHNCQUFzQixDQUFDQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDM0QsU0FBU1MscUJBQXFCQSxDQUFDQyxlQUFlLEVBQUVDLFdBQVcsRUFBRTtFQUMzRCxJQUFJQyxZQUFZLEdBQUcsSUFBSUMsR0FBRyxDQUFDLENBQUM7RUFDNUJILGVBQWUsQ0FBQ0ksT0FBTyxDQUFDLFVBQVVDLEdBQUcsRUFBRTtJQUNyQyxJQUFJLENBQUNKLFdBQVcsQ0FBQ0ssR0FBRyxDQUFDRCxHQUFHLENBQUMsRUFBRTtNQUN6QkgsWUFBWSxDQUFDSyxHQUFHLENBQUNGLEdBQUcsQ0FBQztJQUN2QjtFQUNGLENBQUMsQ0FBQztFQUNGLE9BQU9ILFlBQVk7QUFDckI7QUFDQSxTQUFTTixlQUFlQSxDQUFDWSxJQUFJLEVBQUU7RUFDN0IsSUFBSUMsSUFBSSxHQUFHRCxJQUFJLElBQUksQ0FBQyxDQUFDO0lBQ25CRSxRQUFRLEdBQUdELElBQUksQ0FBQ0MsUUFBUTtJQUN4QkMsZUFBZSxH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